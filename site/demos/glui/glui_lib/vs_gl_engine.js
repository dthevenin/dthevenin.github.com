var util=vs.util,core=vs.core,ui=vs.ui,VSObject=vs.core.Object;glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:Array;function deepArrayClone(a){var b,c,d;if(a instanceof window.Float32Array)b=new Float32Array(a.length),b.set(a);else if(a instanceof Array){c=a.length;b=Array(c);for(d=0;d<c;d++)b[d]=deepArrayClone(a[d])}else b=a;return b}
function CubicBezier(a,b,c,d,e){var f=0,g=0,h=0,j=0,k=0,l=0,h=3*b,g=3*(d-b)-h,f=1-h-g,l=3*c,k=3*(e-c)-l,j=1-l-k;return function(a){return((j*a+k)*a+l)*a}(function(a){var b,c,d,e;for(d=a,c=0;8>c;c++){e=((f*d+g)*d+h)*d-a;if(0.005>(0<=e?e:0-e))return d;b=(3*f*d+2*g)*d+h;if(1.0E-6>(0<=b?b:0-b))break;d-=e/b}b=0;c=1;d=a;if(d<b)return b;if(d>c)return c;for(;b<c;){e=((f*d+g)*d+h)*d;if(0.005>(0<=e-a?e-a:0-(e-a)))break;a>e?b=d:c=d;d=0.5*(c-b)+b}return d}(a))}
function generateCubicBezierFunction(a,b,c,d){return function(e){return CubicBezier(e,a,b,c,d)}}(function(){"undefined"===typeof window.performance&&(window.performance={});if(!window.performance.now){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}})();
var render_ui,_async_events_queue=[],_sync_event=null,_main_actions_queue=[],_tmp_actions_queue=[],_is_async_events_propagating=!1,_is_sync_events_propagating=!1,_is_action_runing=!1,_is_waiting=!1,setImmediate,scheduleDoActions;
if(window.setImmediate)setImmediate=window.setImmediate.bind(window);else{var is_actions_are_scheduled=!1,queueAction=function(a){_main_actions_queue.push(a);is_actions_are_scheduled||(is_actions_are_scheduled=!0,scheduleDoActions())},doAllActions=function(a){var b=_main_actions_queue;is_actions_are_scheduled=!1;if(b.length){a||performance.now();_main_actions_queue=_tmp_actions_queue;_tmp_actions_queue=b;try{for(var a=0,c=b.length,d;a<c;a++)d=b[a],d.call()}catch(e){e.stack?console.error(e.stack):
console.error(e)}b.length=0}},installPostMessageImplementation=function(){function a(a){a.data===b&&doAllActions()}var b="vs.scheduler"+Math.random();window.addEventListener&&window.addEventListener("message",a,!1);return function(){window.postMessage(b,"*")}};scheduleDoActions=window.postMessage?installPostMessageImplementation():function(){setTimeout(doAllActions,0)};setImmediate=queueAction;window.setImmediate=setImmediate}function Handler(){}var Handler__pool=[];
Handler.prototype.configure=function(a,b){this.obj=a;util.isFunction(b)?this.func_ptr=b:util.isString(b)&&(this.func_name=b)};Handler.retain=function(){return Handler__pool.length?Handler__pool.pop():new Handler};Handler.release=function(a){Handler__pool.push(a)};
function doOneEvent(a,b){function c(){h--;0>=h&&(b?_is_sync_events_propagating=!1:_is_async_events_propagating=!1)}function d(a){if(a)try{if(util.isFunction(a.func_ptr))a.func_ptr.call(a.obj,j);else if(util.isString(a.func_name)&&util.isFunction(a.obj[a.func_name]))a.obj[a.func_name](j);else util.isFunction(a.obj.notify)&&a.obj.notify(j)}catch(b){b.stack?console.error(b.stack):console.error(b)}c()}var e=a.handler_list,f=e.length,g,h=f,j=a.event;b?_is_sync_events_propagating=!0:_is_async_events_propagating=
!0;f||c();for(g=0;g<f;g++)b?d(e[g]):function(a){setImmediate(function(){d(a)})}(e[g])}function doOneAsyncEvent(){!_is_async_events_propagating&&!_is_sync_events_propagating&&doOneEvent(_async_events_queue.shift())}function doOneSyncEvent(){doOneEvent(_sync_event,!0);_sync_event=null}function queueProcAsyncEvent(a,b){a&&b&&(_async_events_queue.push({handler_list:b,event:a}),serviceLoop())}function queueProcSyncEvent(a,b){a&&b&&(_sync_event={handler_list:b,event:a},serviceLoop())}
function serviceLoop(){function a(){_is_waiting=!1;serviceLoop()}_sync_event&&doOneSyncEvent();0===_async_events_queue.length&&0===_main_actions_queue.length||_is_waiting||(_is_async_events_propagating||_is_sync_events_propagating?setImmediate(a):(_main_actions_queue.length&&scheduleDoActions(),_async_events_queue.length&&doOneAsyncEvent()))}var ON_NEXT_FRAME="__on_next_frame__";
function scheduleAction(a,b){util.isFunction(a)&&(b&&util.isNumber(b)?setTimeout(a,b):b===ON_NEXT_FRAME?vs.requestAnimationFrame(a):setImmediate(a))}util.extend(vs,{scheduleAction:scheduleAction,ON_NEXT_FRAME:ON_NEXT_FRAME});
var vec2={create:function(a){var b=new glMatrixArrayType(2);a&&(b[0]=a[0],b[1]=a[1]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];return b}},vec3={create:function(a){var b=new glMatrixArrayType(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},set_p:function(a,b,c,d){d[0]=a;d[1]=b;d[2]=c;return d},add:function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,
b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);if(f){if(1==f)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;return b},
cross:function(a,b,c){c||(c=a);var d=a[0],e=a[1],a=a[2],f=b[0],g=b[1],b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c},length:function(a){var b=a[0],c=a[1],a=a[2];return Math.sqrt(b*b+c*c+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1],a=a[2]-b[2],b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+
c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"}},mat3={create:function(a){var b=new glMatrixArrayType(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||
a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},
mat4={create:function(a){var b=new glMatrixArrayType(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=
1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=f;a[11]=a[14];a[12]=e;a[13]=g;a[14]=h;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=
a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],p=a[12],o=a[13],q=a[14],a=a[15];return p*l*h*e-k*o*h*e-p*g*m*e+f*o*m*e+k*g*q*e-f*l*q*e-p*l*d*j+k*o*d*j+p*c*m*j-b*o*m*j-k*c*q*j+b*l*q*j+p*g*d*n-f*o*d*n-p*c*h*n+b*o*h*n+f*c*q*n-b*g*q*n-k*g*d*a+f*l*d*a+k*c*h*a-b*l*h*a-f*c*m*a+b*g*m*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],p=a[11],o=a[12],q=a[13],t=a[14],r=a[15],u=c*h-d*g,C=c*j-e*g,s=c*k-f*g,z=
d*j-e*h,w=d*k-f*h,x=e*k-f*j,y=l*q-m*o,A=l*t-n*o,B=l*r-p*o,D=m*t-n*q,E=m*r-p*q,F=n*r-p*t,v=1/(u*F-C*E+s*D+z*B-w*A+x*y);b[0]=(h*F-j*E+k*D)*v;b[1]=(-d*F+e*E-f*D)*v;b[2]=(q*x-t*w+r*z)*v;b[3]=(-m*x+n*w-p*z)*v;b[4]=(-g*F+j*B-k*A)*v;b[5]=(c*F-e*B+f*A)*v;b[6]=(-o*x+t*s-r*C)*v;b[7]=(l*x-n*s+p*C)*v;b[8]=(g*E-h*B+k*y)*v;b[9]=(-c*E+d*B-f*y)*v;b[10]=(o*w-q*s+r*u)*v;b[11]=(-l*w+m*s-p*u)*v;b[12]=(-g*D+h*A-j*y)*v;b[13]=(c*D-d*A+e*y)*v;b[14]=(-o*z+q*C-t*u)*v;b[15]=(l*z-m*C+n*u)*v;return b}};
mat4.toRotationMat=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};mat4.toMat3=function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};
mat4.toInverseMat3=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],h=a[6],j=a[8],k=a[9],l=a[10],m=l*g-h*k,n=-l*f+h*j,p=k*f-g*j,o=c*m+d*n+e*p;if(!o)return null;o=1/o;b||(b=mat3.create());b[0]=m*o;b[1]=(-l*d+e*k)*o;b[2]=(h*d-e*g)*o;b[3]=n*o;b[4]=(l*c-e*j)*o;b[5]=(-h*c+e*f)*o;b[6]=p*o;b[7]=(-k*c+d*j)*o;b[8]=(g*c-d*f)*o;return b};
mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],j=a[5],k=a[6],l=a[7],m=a[8],n=a[9],p=a[10],o=a[11],q=a[12],t=a[13],r=a[14],a=a[15],u=b[0],C=b[1],s=b[2],z=b[3],w=b[4],x=b[5],y=b[6],A=b[7],B=b[8],D=b[9],E=b[10],F=b[11],v=b[12],G=b[13],H=b[14],b=b[15];c[0]=u*d+C*h+s*m+z*q;c[1]=u*e+C*j+s*n+z*t;c[2]=u*f+C*k+s*p+z*r;c[3]=u*g+C*l+s*o+z*a;c[4]=w*d+x*h+y*m+A*q;c[5]=w*e+x*j+y*n+A*t;c[6]=w*f+x*k+y*p+A*r;c[7]=w*g+x*l+y*o+A*a;c[8]=B*d+D*h+E*m+F*q;c[9]=B*e+D*j+E*n+F*t;c[10]=B*f+D*
k+E*p+F*r;c[11]=B*g+D*l+E*o+F*a;c[12]=v*d+G*h+H*m+b*q;c[13]=v*e+G*j+H*n+b*t;c[14]=v*f+G*k+H*p+b*r;c[15]=v*g+G*l+H*o+b*a;return c};mat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};mat4.multiplyXYZToVec3=function(a,b,c,d,e){e[0]=a[0]*b+a[4]*c+a[8]*d+a[12];e[1]=a[1]*b+a[5]*c+a[9]*d+a[13];e[2]=a[2]*b+a[6]*c+a[10]*d+a[14]};
mat4.multiplyVec4=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2],b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b;return c};
mat4.translate=function(a,b,c){var d=b[0],e=b[1],b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var f=a[0],g=a[1],h=a[2],j=a[3],k=a[4],l=a[5],m=a[6],n=a[7],p=a[8],o=a[9],q=a[10],t=a[11];c[0]=f;c[1]=g;c[2]=h;c[3]=j;c[4]=k;c[5]=l;c[6]=m;c[7]=n;c[8]=p;c[9]=o;c[10]=q;c[11]=t;c[12]=f*d+k*e+p*b+a[12];c[13]=g*d+l*e+o*b+a[13];c[14]=h*d+m*e+q*b+a[14];c[15]=j*d+n*e+t*b+a[15];return c};
mat4.translateXYZ=function(a,b,c,d){a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=a[1]*b+a[5]*c+a[9]*d+a[13];a[14]=a[2]*b+a[6]*c+a[10]*d+a[14];a[15]=a[3]*b+a[7]*c+a[11]*d+a[15]};
mat4.scale=function(a,b,c){var d=b[0],e=b[1],b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};mat4.scaleXY=function(a,b){a[0]*=b;a[1]*=b;a[2]*=b;a[3]*=b;a[4]*=b;a[5]*=b;a[6]*=b;a[7]*=b};
mat4.rotate=function(a,b,c,d){var e=c[0],f=c[1],c=c[2],g=Math.sqrt(e*e+f*f+c*c);if(!g)return null;1!=g&&(g=1/g,e*=g,f*=g,c*=g);var h=Math.sin(b),j=Math.cos(b),k=1-j,b=a[0],g=a[1],l=a[2],m=a[3],n=a[4],p=a[5],o=a[6],q=a[7],t=a[8],r=a[9],u=a[10],C=a[11],s=e*e*k+j,z=f*e*k+c*h,w=c*e*k-f*h,x=e*f*k-c*h,y=f*f*k+j,A=c*f*k+e*h,B=e*c*k+f*h,e=f*c*k-e*h,f=c*c*k+j;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*s+n*z+t*w;d[1]=g*s+p*z+r*w;d[2]=l*s+o*z+u*w;d[3]=m*s+q*z+C*w;d[4]=b*x+n*y+t*A;d[5]=
g*x+p*y+r*A;d[6]=l*x+o*y+u*A;d[7]=m*x+q*y+C*A;d[8]=b*B+n*e+t*f;d[9]=g*B+p*e+r*f;d[10]=l*B+o*e+u*f;d[11]=m*B+q*e+C*f;return d};mat4.rotateX=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],j=a[8],k=a[9],l=a[10],m=a[11];a[4]=e*d+j*c;a[5]=f*d+k*c;a[6]=g*d+l*c;a[7]=h*d+m*c;a[8]=e*-c+j*d;a[9]=f*-c+k*d;a[10]=g*-c+l*d;a[11]=h*-c+m*d};
mat4.rotateY=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],j=a[8],k=a[9],l=a[10],m=a[11];a[0]=e*d+j*-c;a[1]=f*d+k*-c;a[2]=g*d+l*-c;a[3]=h*d+m*-c;a[8]=e*c+j*d;a[9]=f*c+k*d;a[10]=g*c+l*d;a[11]=h*c+m*d};mat4.rotateZ=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],j=a[4],k=a[5],l=a[6],m=a[7];a[0]=e*d+j*c;a[1]=f*d+k*c;a[2]=g*d+l*c;a[3]=h*d+m*c;a[4]=e*-c+j*d;a[5]=f*-c+k*d;a[6]=g*-c+l*d;a[7]=h*-c+m*d};
mat4.frustum=function(a,b,c,d,e,f,g){g||(g=mat4.create());var h=b-a,j=d-c,k=f-e;g[0]=2*e/h;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*e/j;g[6]=0;g[7]=0;g[8]=(b+a)/h;g[9]=(d+c)/j;g[10]=-(f+e)/k;g[11]=-1;g[12]=0;g[13]=0;g[14]=-(2*f*e)/k;g[15]=0;return g};mat4.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,c,d,e)};
mat4.ortho=function(a,b,c,d,e,f,g){g||(g=mat4.create());var h=b-a,j=d-c,k=f-e;g[0]=2/h;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2/j;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=-2/k;g[11]=0;g[12]=-(a+b)/h;g[13]=-(d+c)/j;g[14]=-(f+e)/k;g[15]=1;return g};
mat4.lookAt=function(a,b,c,d){d||(d=mat4.create());var e=a[0],f=a[1],a=a[2],g=c[0],h=c[1],j=c[2],c=b[1],k=b[2];if(e==b[0]&&f==c&&a==k)return mat4.identity(d);var l,m,n,p,c=e-b[0],k=f-b[1],b=a-b[2];p=1/Math.sqrt(c*c+k*k+b*b);c*=p;k*=p;b*=p;l=h*b-j*k;j=j*c-g*b;g=g*k-h*c;(p=Math.sqrt(l*l+j*j+g*g))?(p=1/p,l*=p,j*=p,g*=p):g=j=l=0;h=k*g-b*j;m=b*l-c*g;n=c*j-k*l;(p=Math.sqrt(h*h+m*m+n*n))?(p=1/p,h*=p,m*=p,n*=p):n=m=h=0;d[0]=l;d[1]=h;d[2]=c;d[3]=0;d[4]=j;d[5]=m;d[6]=k;d[7]=0;d[8]=g;d[9]=n;d[10]=b;d[11]=0;
d[12]=-(l*e+j*f+g*a);d[13]=-(h*e+m*f+n*a);d[14]=-(c*e+k*f+b*a);d[15]=1;return d};mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};function allocateMeshVertices(a,b){b||(b=new Float32Array(3*(a+1)*(a+1)));var c=0,d,e;for(d=0;d<a+1;d++){b[c++]=0;b[c++]=0;b[c++]=0;for(e=1;e<a+1;e++)b[c++]=0,b[c++]=0,b[c++]=0}return b}
function allocateNormalVertices(a,b){b||(b=new Float32Array(3*(a+1)*(a+1)));var c=0,d,e;for(d=0;d<a+1;d++){b[c++]=0;b[c++]=0;for(e=b[c++]=1;e<a+1;e++)b[c++]=0,b[c++]=0,b[c++]=1}return b}function makeTextureProjection(a,b){var c=1/a;b||(b=new Float32Array(2*(a+1)*(a+1)));var d=0,e,f,g,h;for(e=0;e<a+1;e++){g=c*e;h=0;b[d++]=g;b[d++]=h;for(f=1;f<a+1;f++)h=c*f,b[d++]=g,b[d++]=h}return b}
function allocateTriangleFaces(a,b){b||(b=new Uint16Array(6*a*a));var c=0,d,e,f=0;for(d=0;d<a;d++){for(e=0;e<a;e++)b[c++]=f,b[c++]=f+a+1,b[c++]=f+1,b[c++]=f+1,b[c++]=f+a+1,b[c++]=f+a+2,f++;f++}return b}function initMeshVeticesValues(a,b,c,d,e,f){d/=a;e/=a;if(f){var g=0,h,j,k,l;for(h=0;h<a+1;h++){k=b+d*h;l=c;f[g++]=k;f[g++]=l;f[g++]=0;for(j=1;j<a+1;j++)l=c+e*j,f[g++]=k,f[g++]=l,f[g++]=0}return f}}
var SPRITES=[],SPRITE_ALLOCATIONS=[],__unique_gl_id=1,GL_VIEWS=[],default_triangle_faces=new Uint16Array([0,1,2,3]);function createSprite(a){var b=__unique_gl_id++;a.__gl_id=b;GL_VIEWS[b]=a;new Sprite(a.__gl_id);a.__update_gl_vertices&&(setUpdateVerticesSprite(a,a.__update_gl_vertices),a.__update_gl_vertices=void 0)}function deleteSprite(a){a=SPRITES[a.__gl_id];a.texture&&(gl_ctx.deleteTexture(a.texture),a.texture=null)}
function setVerticesAllocationFunctions(a,b,c,d,e,f){if(a){var g=new Sprite(a.__gl_id);if(g){var h={};h.resolution=b;h.sprite_vertices_func=c;h.normal_vertices_func=d;h.triangle_faces_func=e;h.texture_projection_func=f;SPRITE_ALLOCATIONS[a.__gl_id]=h;g.default_meshes=!1}}}
function Sprite(a){this.matrix=mat4.create();this.p_matrix=mat4.create();this.m_matrix=mat4.create();this.id=a;SPRITES[this.id]=this;this.mesh_vertices_buffer=gl_ctx.createBuffer();this.vertex_1=vec3.create();this.vertex_2=vec3.create();this.vertex_3=vec3.create();this.vertex_4=vec3.create()}function defaultSpriteVerticesAllocation(a){a.mesh_vertices=new Float32Array(12);a.triangle_faces=null;a.normal_vertices=null;a.texture_uv=null}
function initSprite(a){if(a){var b=SPRITES[a.__gl_id];b&&(b.default_meshes?defaultSpriteVerticesAllocation(b):(a=SPRITE_ALLOCATIONS[a.__gl_id])?(a.sprite_vertices_func&&(b.mesh_vertices=a.sprite_vertices_func(a.resolution,b.mesh_vertices)),a.normal_vertices_func&&(b.normal_vertices=a.normal_vertices_func(a.resolution,b.normal_vertices)),a.triangle_faces_func&&(b.triangle_faces=a.triangle_faces_func(a.resolution,b.triangle_faces)),a.texture_projection_func&&(b.texture_uv=a.texture_projection_func(a.resolution,
b.texture_uv))):defaultSpriteVerticesAllocation(b))}}Sprite.prototype.default_meshes=!0;Sprite.prototype.mesh_vertices=null;Sprite.prototype.normal_vertices=null;Sprite.prototype.triangle_faces=null;Sprite.prototype.texture_uv=null;Sprite.prototype.mesh_vertices_buffer=null;Sprite.prototype.texture=null;Sprite.prototype.image_texture=null;
Sprite.restoreGLContext=function(){for(var a,b=0,c=SPRITES.length;b<c;b++)if(a=SPRITES[b])delete a.mesh_vertices_buffer,a.mesh_vertices_buffer=gl_ctx.createBuffer(),a.texture&&(delete a.texture,a.texture=gl_ctx.createTexture()),a.image_texture&&(delete a.image_texture,a.image_texture=gl_ctx.createTexture());(a=webglcontextrestored_listeners[a.id])&&a.forEach(function(a){try{a()}catch(b){b.stack?console.log(b.stack):consoel.log(b)}})};
function setUpdateVerticesSprite(a,b){if(a){var c=SPRITES[a.__gl_id];c&&(c.__update_gl_vertices=b)}}function setShadersProgram(a,b){if(a){var c=SPRITES[a.__gl_id];c&&(c.user_program=b)}}function clean_image_texture(a){a=SPRITES[a.__gl_id];a.image_texture&&(a.image_texture=null)}function set_image_texture(a,b){SPRITES[a.__gl_id].image_texture=b}function update_texture(a,b){var c=SPRITES[a.__gl_id];c.texture=__copy_image_into_webgl_texture(b,c.texture)}var webglcontextrestored_listeners=[];
function register_webglcontextrestored(a,b){if(a&&b&&SPRITES[a.__gl_id]){var c=webglcontextrestored_listeners[a.__gl_id];c||(c=[],webglcontextrestored_listeners[a.__gl_id]=c);c.push(b)}}
var get_shader=function(a,b,c){a=gl_ctx.createShader(a);if(null==a)return vs.error("couldn't create a shader"),null;gl_ctx.shaderSource(a,b);gl_ctx.compileShader(a);return!gl_ctx.getShaderParameter(a,gl_ctx.COMPILE_STATUS)&&!gl_ctx.isContextLost()?(b=this.gl_ctx.getShaderInfoLog(a),vs.error("Error compiling "+c+"shader:\n"+b),gl_ctx.deleteShader(a),null):a};function glslNameToJs_(a){return a.replace(/_(.)/g,function(a,c){return c.toUpperCase()})}
function Program(){this.__prog=gl_ctx.createProgram()}
function createSetters(a){function b(a,b){if(1!=a.size)throw"arrays of attribs not handled";return function(a){gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,a.buffer);gl_ctx.enableVertexAttribArray(b);gl_ctx.vertexAttribPointer(b,a.numComponents,a.type,a.normalize,a.stride,a.offset)}}function c(a){var b=gl_ctx.getUniformLocation(d,a.name),a=a.type;if(a===gl_ctx.FLOAT)return function(a){gl_ctx.uniform1f(b,a)};if(a===gl_ctx.FLOAT_VEC2)return function(a){gl_ctx.uniform2fv(b,a)};if(a===gl_ctx.FLOAT_VEC3)return function(a){gl_ctx.uniform3fv(b,
a)};if(a===gl_ctx.FLOAT_VEC4)return function(a){gl_ctx.uniform4fv(b,a)};if(a===gl_ctx.INT)return function(a){gl_ctx.uniform1i(b,a)};if(a===gl_ctx.INT_VEC2)return function(a){gl_ctx.uniform2iv(b,a)};if(a===gl_ctx.INT_VEC3)return function(a){gl_ctx.uniform3iv(b,a)};if(a===gl_ctx.INT_VEC4)return function(a){gl_ctx.uniform4iv(b,a)};if(a===gl_ctx.BOOL)return function(a){gl_ctx.uniform1i(b,a)};if(a===gl_ctx.BOOL_VEC2)return function(a){gl_ctx.uniform2iv(b,a)};if(a===gl_ctx.BOOL_VEC3)return function(a){gl_ctx.uniform3iv(b,
a)};if(a===gl_ctx.BOOL_VEC4)return function(a){gl_ctx.uniform4iv(b,a)};if(a===gl_ctx.FLOAT_MAT2)return function(a){gl_ctx.uniformMatrix2fv(b,!1,a)};if(a===gl_ctx.FLOAT_MAT3)return function(a){gl_ctx.uniformMatrix3fv(b,!1,a)};if(a===gl_ctx.FLOAT_MAT4)return function(a){gl_ctx.uniformMatrix4fv(b,!1,a)};if(a===gl_ctx.SAMPLER_2D||a===gl_ctx.SAMPLER_CUBE)return function(a){return function(b,c){b.bindToUnit(a,c)}}(m++);throw"unknown type: 0x"+a.toString(16);}var d=a.__prog,e={},f={},g=gl_ctx.getProgramParameter(d,
gl_ctx.ACTIVE_ATTRIBUTES);if(g&&!gl_ctx.isContextLost())for(var h=0;h<g;++h){var j=gl_ctx.getActiveAttrib(d,h);if(!j)break;var k=j.name,l=gl_ctx.getAttribLocation(d,k);e[k]=b(j,l);f[k]=l}var g=gl_ctx.getProgramParameter(d,gl_ctx.ACTIVE_UNIFORMS),l={},m=0,n={};if(g&&!gl_ctx.isContextLost())for(h=0;h<g;++h){j=gl_ctx.getActiveUniform(d,h);if(!j)break;var k=j.name,p=c(j);l[k]=p;if(j.type===gl_ctx.SAMPLER_2D||j.type===gl_ctx.SAMPLER_CUBE)n[k]=p}a.textures=n;a.attrib=e;a.attribLoc=f;a.uniform=l}
Program.prototype.useIt=function(){gl_ctx.useProgram(this.__prog)};Program.prototype.setMatrixes=function(a,b){this.useIt();this.uniform.Pmatrix(a);this.uniform.Vmatrix(b)};Program.prototype.configureParameters=function(){};
function createProgram(a,b){var c=new Program,d=get_shader(gl_ctx.VERTEX_SHADER,a,"VERTEX");d||vs.log("couldn't load shader");gl_ctx.attachShader(c.__prog,d);gl_ctx.deleteShader(d);(d=get_shader(gl_ctx.FRAGMENT_SHADER,b,"FRAGMENT"))||vs.log("couldn't load shader");gl_ctx.attachShader(c.__prog,d);gl_ctx.deleteShader(d);gl_ctx.linkProgram(c.__prog);gl_ctx.useProgram(c.__prog);if(!gl_ctx.getProgramParameter(c.__prog,gl_ctx.LINK_STATUS)&&!gl_ctx.isContextLost())d=gl_ctx.getProgramInfoLog(c.__prog),vs.error("Error linking program:\n"+
d),gl_ctx.deleteProgram(c.__prog),c.__prog=null;else return createSetters(c),c}vs.log=console.log.bind(console);vs.error=console.error.bind(console);var basicShaderProgram,shadowShaderProgram,imageShaderProgram,oneTextureShaderProgram,twoTexturesShaderProgram,gl_ctx,object_uv_buffer,object_bck_image_uv_buffer,default_object_bck_image_uv_buffer,object_faces_buffer,frame_size=[100,100],gl_device_pixel_ratio,default_texture_projection;
function createCanvas(a,b){var c=document.createElement("canvas");c.style.width=a+"px";c.style.height=b+"px";c.width=a*gl_device_pixel_ratio;c.height=b*gl_device_pixel_ratio;if(deviceConfiguration.browser!==vs.core.DeviceConfiguration.BROWSER_FIREFOX&&1!==gl_device_pixel_ratio){var d=["crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast"];if(void 0!==c.style.imageRendering)for(var e=0;e<d.length&&!(c.style.imageRendering=d[e],c.style.imageRendering==d[e]);e++);else void 0!==c.style["-ms-interpolation-mode"]&&
(c.style["-ms-interpolation-mode"]="nearest-neighbor")}return c}function create2DCanvas(a,b){var c=createCanvas(a,b),d=c.getContext("2d");d.webkitImageSmoothingEnabled=!1;d.mozImageSmoothingEnabled=!1;d.imageSmoothingEnabled=!1;return c}
function initPrograms(){basicShaderProgram=createProgram("\nattribute vec3 position;\nuniform mat4 Pmatrix;\nuniform mat4 Vmatrix;\nuniform mat4 Mmatrix;\nvoid main(void) { //pre-built function\n  vec4 new_pos = vec4(position, 1.);\n  gl_Position = Pmatrix*Vmatrix*Mmatrix*new_pos;\n}","\nprecision lowp float;\nuniform vec4 color;\nuniform float uAlpha;\nvoid main(void) {\n  gl_FragColor = vec4(color.rgb, color.a * uAlpha);\n}");shadowShaderProgram=createProgram("\nattribute vec3 position;\nuniform mat4 Pmatrix;\nuniform mat4 Vmatrix;\nuniform mat4 Mmatrix;\nvarying vec2 vPos;\nvoid main(void) { //pre-built function\n  vec4 temp_pos = Vmatrix*Mmatrix*vec4(position, 1.);\n  gl_Position = Pmatrix*temp_pos;\n  vPos = position.xy;\n}",
"\nprecision lowp float;\nuniform vec4 color;\nuniform float uAlpha;\nuniform float blur;\nuniform vec4 frame;\nvarying vec2 vPos;\nvoid main(void) {\n  float shine = \n    smoothstep(frame[0], frame[0] + blur, vPos.x) * \n    smoothstep(frame[1], frame[1] - blur, vPos.x) * \n    smoothstep(frame[2], frame[2] + blur, vPos.y) * \n    smoothstep(frame[3], frame[3] - blur, vPos.y); \n\n  gl_FragColor = vec4(color.rgb, shine * color.a * uAlpha);\n}");imageShaderProgram=createProgram("\nattribute vec3 position;\nuniform mat4 Pmatrix;\nuniform mat4 Vmatrix;\nuniform mat4 Mmatrix;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main(void) { //pre-built function\n  gl_Position = Pmatrix*Vmatrix*Mmatrix*vec4(position, 1.);\n  vUV=uv;\n}",
"\nprecision lowp float;\nvarying vec2 vUV;\nuniform sampler2D uMainTexture;\nuniform vec4 color;\nuniform float uAlpha;\nvoid main(void) {\n  vec4 mainTextureColor = texture2D(uMainTexture, vUV);\n  gl_FragColor = mainTextureColor;\n  gl_FragColor.a *= uAlpha;\n}");oneTextureShaderProgram=createProgram("\nattribute vec3 position;\nuniform mat4 Pmatrix;\nuniform mat4 Vmatrix;\nuniform mat4 Mmatrix;\nattribute vec2 bkImageUV;\nvarying vec2 vBkImageUV;\nvoid main(void) { //pre-built function\n  gl_Position = Pmatrix*Vmatrix*Mmatrix*vec4(position, 1.);\n  vBkImageUV=bkImageUV;\n}",
"\nprecision lowp float;\nvarying vec2 vBkImageUV;\nuniform sampler2D uMainTexture;\nuniform vec4 color;\nuniform float uAlpha;\nvoid main(void) {\n  if (vBkImageUV[0]<0.0 || vBkImageUV[1]<0.0 || vBkImageUV[0]>1.0 || vBkImageUV[1]>1.0) {\n    gl_FragColor = color;\n  } else {\n    vec4 mainTextureColor = texture2D(uMainTexture, vBkImageUV);\n    gl_FragColor = mix(color, mainTextureColor, mainTextureColor.a);\n    gl_FragColor.a = max(color.a, mainTextureColor.a);\n  }\n  gl_FragColor.a *= uAlpha;\n}");
twoTexturesShaderProgram=createProgram("\nattribute vec3 position;\nuniform mat4 Pmatrix;\nuniform mat4 Vmatrix;\nuniform mat4 Mmatrix;\nattribute vec2 uv;\nattribute vec2 bkImageUV;\nvarying vec2 vUV;\nvarying vec2 vBkImageUV;\nvoid main(void) { //pre-built function\n  gl_Position = Pmatrix*Vmatrix*Mmatrix*vec4(position, 1.);\n  vUV=uv;\n  vBkImageUV=bkImageUV;\n}","\nprecision lowp float;\nvarying vec2 vUV;\nvarying vec2 vBkImageUV;\nuniform sampler2D uBckTexture;\nuniform sampler2D uMainTexture;\nuniform float uTextureFlag;\nuniform vec4 color;\nuniform float uAlpha;\nvoid main(void) {\n  vec4 mainTextureColor = texture2D(uMainTexture, vUV);\n  vec4 tmpColor;\n  if (vBkImageUV[0]<0.0 || vBkImageUV[1]<0.0 || vBkImageUV[0]>1.0 || vBkImageUV[1]>1.0) {\n    tmpColor = color;\n  } else {\n    vec4 bckTextureColor = texture2D(uBckTexture, vBkImageUV);\n    tmpColor = mix(color, bckTextureColor, bckTextureColor.a);\n    tmpColor.a = max(color.a, bckTextureColor.a);\n  }\n  gl_FragColor = mix(tmpColor, mainTextureColor, mainTextureColor.a);\n  gl_FragColor.a = max(tmpColor.a, mainTextureColor.a) * uAlpha;\n}")}
function initMainMatrix(){jsProjMatrix=mat4.create();mat4.identity(jsProjMatrix);mat4.perspective(0.191,1,-1,10,jsProjMatrix);jsViewMatrix=mat4.create();mat4.identity(jsViewMatrix);mat4.translate(jsViewMatrix,[-1,1,-600]);mat4.scale(jsViewMatrix,[2/frame_size[0],-2/frame_size[1],1])}
function updateProgramsMatrix(){imageShaderProgram.setMatrixes(jsProjMatrix,jsViewMatrix);twoTexturesShaderProgram.setMatrixes(jsProjMatrix,jsViewMatrix);oneTextureShaderProgram.setMatrixes(jsProjMatrix,jsViewMatrix);basicShaderProgram.setMatrixes(jsProjMatrix,jsViewMatrix);shadowShaderProgram.setMatrixes(jsProjMatrix,jsViewMatrix)}
function initBuffers(){default_texture_projection=new Float32Array([0,0,0,1,1,0,1,1]);object_uv_buffer&&delete object_uv_buffer;object_uv_buffer=gl_ctx.createBuffer();gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,object_uv_buffer);gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,default_texture_projection,gl_ctx.STATIC_DRAW);object_bck_image_uv_buffer&&delete object_bck_image_uv_buffer;object_bck_image_uv_buffer=gl_ctx.createBuffer();gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,object_bck_image_uv_buffer);gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,
default_texture_projection,gl_ctx.STATIC_DRAW);default_object_bck_image_uv_buffer&&delete default_object_bck_image_uv_buffer;default_object_bck_image_uv_buffer=gl_ctx.createBuffer();gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,default_object_bck_image_uv_buffer);gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,default_texture_projection,gl_ctx.STATIC_DRAW);object_faces_buffer&&delete object_faces_buffer;object_faces_buffer=gl_ctx.createBuffer();gl_ctx.bindBuffer(gl_ctx.ELEMENT_ARRAY_BUFFER,object_faces_buffer);gl_ctx.bindBuffer(gl_ctx.ELEMENT_ARRAY_BUFFER,
object_faces_buffer);gl_ctx.bufferData(gl_ctx.ELEMENT_ARRAY_BUFFER,default_triangle_faces,gl_ctx.STATIC_DRAW)}var GL_CANVAS,stats,init_functions=[];function glAddInitFunction(a){init_functions.push(a)}
function initWebGLRendering(){if(!gl_ctx){window.ACTIVATE_STATS&&vs.util.importFile("../../src/Stats.js",null,function(){stats=Stats();document.body.appendChild(stats.domElement);stats.setMode(1)},"js");frame_size=[window.innerWidth,window.innerHeight];gl_device_pixel_ratio=window.devicePixelRatio||1;deviceConfiguration.browser===vs.core.DeviceConfiguration.BROWSER_FIREFOX&&(gl_device_pixel_ratio=1);console.log(gl_device_pixel_ratio);var a=GL_CANVAS=createCanvas(frame_size[0],frame_size[1]);document.body.appendChild(a);
a.addEventListener("webglcontextlost",handleContextLost,!1);a.addEventListener("webglcontextrestored",function(){console.log("webglcontextrestored");setupWebGLStateAndResources();Sprite.restoreGLContext();GLStyle.restoreGLContext()},!1);setupWebGLStateAndResources()}}
function setupWebGLStateAndResources(){for(var a={antialias:!0,premultipliedAlpha:!1,alpha:!1},b=["webgl","experimental-webgl","webkit-3d","moz-webgl"],c=0;c<b.length;++c){try{gl_ctx=GL_CANVAS.getContext(b[c],a)}catch(d){}if(gl_ctx)break}if(!gl_ctx)throw alert("You are not webgl compatible :("),"You are not webgl compatible :(";initPrograms();initMainMatrix();initBuffers();initPickBuffer();gl_ctx.disable(gl_ctx.DEPTH_TEST);gl_ctx.enable(gl_ctx.BLEND);gl_ctx.blendFunc(gl_ctx.SRC_ALPHA,gl_ctx.ONE_MINUS_SRC_ALPHA);
gl_ctx.clearDepth(1);gl_ctx.clearColor(1,1,1,1);init_functions.forEach(function(a){a()});updateProgramsMatrix();initRendering()}function update_gl_vertices(a,b,c){var d=b[0],b=b[1],e=c[0],c=c[1],a=a.mesh_vertices;a[0]=d;a[1]=b;a[2]=0;a[3]=d;a[4]=b+c;a[5]=0;a[6]=d+e;a[7]=b;a[8]=0;a[9]=d+e;a[10]=b+c;a[11]=0}
function update_shadow_gl_vertices(a,b,c,d){var e=a[0]+c[0]-d,a=a[1]+c[1]-d,c=b[0]+2*d,b=b[1]+2*d,d=shadow_vertices;d[0]=e;d[1]=a;d[2]=0;d[3]=e;d[4]=a+b;d[5]=0;d[6]=e+c;d[7]=a;d[8]=0;d[9]=e+c;d[10]=a+b;d[11]=0;gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,shadow_buffer);gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,d,gl_ctx.STATIC_DRAW)}var angle2rad=Math.PI/180;
function update_transform_gl_matrix(a,b){var c=b.matrix,d=a._position,e=a._size,f=a._rotation,g=a._translation,h=a._transform_origin[0]+d[0],j=a._transform_origin[1]+d[1];mat4.identity(c);mat4.translateXYZ(c,h+g[0],j+g[1],g[2]);f[0]&&mat4.rotateX(c,f[0]*angle2rad);f[1]&&mat4.rotateY(c,f[1]*angle2rad);f[2]&&mat4.rotateZ(c,f[2]*angle2rad);mat4.scaleXY(c,a._scaling);mat4.translateXYZ(c,-h,-j,0);update_envelop_vertices(b,d,e);a.__invalid_matrixes=!0;GLView.__should_render=!0;a.__should_update_gl_matrix=
!1}function update_envelop_vertices(a,b,c){var d=a.matrix,e=b[0],f=b[1],b=b[2],g=c[0],c=c[1];mat4.multiplyXYZToVec3(d,e,f,b,a.vertex_1);mat4.multiplyXYZToVec3(d,e,f+c,b,a.vertex_2);mat4.multiplyXYZToVec3(d,e+g,f,b,a.vertex_3);mat4.multiplyXYZToVec3(d,e+g,f+c,b,a.vertex_4)}var next_rendering_id=0,gl_stack_length=0,gl_stack_for_renter=[1024],gl_boundaries_stack=[256],v_temp=vec3.create();
function isInFrustum(a,b,c,d){var e=gl_boundaries_stack[b],f=a.vertex_1,g=a.vertex_2,h=a.vertex_3,a=a.vertex_4;if(f[0]>e[2]&&g[0]>e[2]&&h[0]>e[2]&&a[0]>e[2]||f[0]<e[0]&&g[0]<e[0]&&h[0]<e[0]&&a[0]<e[0]||f[1]>e[3]&&g[1]>e[3]&&h[1]>e[3]&&a[1]>e[3]||f[1]<e[1]&&g[1]<e[1]&&h[1]<e[1]&&a[1]<e[1])return!1;e=gl_boundaries_stack[b+1];d?(vec3.subtract([0,0,0],d,v_temp),e[0]=v_temp[0],e[1]=v_temp[1],vec3.subtract([c[0],c[1],0],d,v_temp),e[2]=v_temp[0],e[3]=v_temp[1]):(e[0]=0,e[1]=0,e[2]=c[0],e[3]=c[1]);return!0}
function calculateViewsInFrustum(a){function b(c,d,e,j,k){var l,m,n;if(c._visible||c.__is_hidding)if(l=SPRITES[c.__gl_id],gl_update_animation(c,a),j=(n=c._style)?j*n._opacity:j,0!==j){c.__should_update_gl_matrix&&update_transform_gl_matrix(c,l);m=l.matrix;var p=l.m_matrix;n=l.p_matrix;var o=c._size,q=c.__gl_scroll;if(e||c.__invalid_matrixes)d?mat4.multiply(d,m,p):mat4.set(m,p);if(e||c.__invalid_matrixes||c.__is_scrolling)mat4.translate(p,c._position,n),q&&(c.__gl_update_scroll(a),mat4.translate(n,
q)),e=!0;c.__invalid_matrixes=!1;if(isInFrustum(l,k,o,q)){d=gl_stack_for_renter[gl_views_index++];d[0]=1;d[1]=c;d[2]=j;m=c.__children;d=m.length;for(c=0;c<d;c++)l=m[c],l.__gl_id&&b(l,n,e,j,k+1)}}}var c=vs.Application_applications,d;gl_views_index=gl_stack_length=0;var e=gl_boundaries_stack[0];e[0]=0;e[1]=0;e[2]=frame_size[0];e[3]=frame_size[1];for(d in c)b(c[d],null,!1,1,0);gl_stack_length=gl_views_index}var shadow_buffer,shadow_vertices=new Float32Array(12),rendering_mode=0;
function initRendering(){function a(a,b){gl_ctx.activeTexture(gl_ctx.TEXTURE0+a);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,b.texture)}function b(a,b){gl_ctx.activeTexture(gl_ctx.TEXTURE0+a);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,b.image_texture)}function c(a,b){gl_ctx.activeTexture(gl_ctx.TEXTURE0+a);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,b.__gl_texture_bck_image)}function d(e,n,p){var o,q=SPRITES[e.__gl_id],t;2===p?t=shadow_buffer:(e.__should_update_gl_vertices&&(q.__update_gl_vertices?q.__update_gl_vertices(q,
e._position,e._size):update_gl_vertices(q,e._position,e._size),gl_ctx.bindBuffer(gl_ctx.ARRAY_BUFFER,q.mesh_vertices_buffer),gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,q.mesh_vertices,gl_ctx.STATIC_DRAW),e.__should_update_gl_vertices=!1),t=q.mesh_vertices_buffer);if(1===p){o=basicShaderProgram;h!==basicShaderProgram&&o.useIt();var e=e.__gl_id,r=n=0,n=e%256/255,e=e/255|0,r=e%256/255;f[0]=n;f[1]=r;f[2]=(e/255|0)%256/255;f[3]=1;o.uniform.color(f);n=1}else if(2===p)r=e.style,o=shadowShaderProgram,h!==shadowShaderProgram&&
o.useIt(),o.uniform.color(r._shadow_color.__gl_array),r._shadow_blur?o.uniform.blur(1.75*r._shadow_blur):o.uniform.blur(0.001),update_shadow_gl_vertices(e._position,e._size,r._shadow_offset,r._shadow_blur),o.uniform.frame(new Float32Array([shadow_vertices[0],shadow_vertices[9],shadow_vertices[1],shadow_vertices[10]]));else{var r=e.style,u;r||(r=_default_style);u=r&&r._background_color?r._background_color.__gl_array:GLColor.default.__gl_array;r._shadow_color&&d(e,n,2);q.user_program?(o=q.user_program,
o.useIt(),o.configureParameters&&o.configureParameters(q,e,r)):q.image_texture?(o=imageShaderProgram,h!==imageShaderProgram&&(o.useIt(),j.normalize=!1,j.type=gl_ctx.FLOAT,j.stride=0,j.offset=0,j.buffer=object_uv_buffer,j.numComponents=2,o.attrib.uv(j)),k.bindToUnit=b,o.textures.uMainTexture(k,q)):q.texture&&r.__gl_texture_bck_image?(o=twoTexturesShaderProgram,h!==twoTexturesShaderProgram&&(o.useIt(),j.normalize=!1,j.type=gl_ctx.FLOAT,j.stride=0,j.offset=0,j.buffer=object_uv_buffer,j.numComponents=
2,o.attrib.uv(j)),k.bindToUnit=a,o.textures.uMainTexture(k,q),j.buffer=object_bck_image_uv_buffer,j.numComponents=2,o.attrib.bkImageUV(j),gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,r._background_image_uv,gl_ctx.STATIC_DRAW),l.bindToUnit=c,o.textures.uBckTexture(l,r),o.uniform.color(u)):q.texture?(o=oneTextureShaderProgram,h!==oneTextureShaderProgram&&o.useIt(),j.normalize=!1,j.type=gl_ctx.FLOAT,j.stride=0,j.offset=0,j.buffer=default_object_bck_image_uv_buffer,j.numComponents=2,o.attrib.bkImageUV(j),o.uniform.color(u),
k.bindToUnit=a,o.textures.uMainTexture(k,q)):r.__gl_texture_bck_image?(o=oneTextureShaderProgram,h!==oneTextureShaderProgram&&o.useIt(),j.normalize=!1,j.type=gl_ctx.FLOAT,j.stride=0,j.offset=0,j.buffer=object_bck_image_uv_buffer,j.numComponents=2,o.attrib.bkImageUV(j),gl_ctx.bufferData(gl_ctx.ARRAY_BUFFER,r._background_image_uv,gl_ctx.STATIC_DRAW),o.uniform.color(u),k.bindToUnit=c,o.textures.uMainTexture(k,r)):(o=basicShaderProgram,h!==basicShaderProgram&&o.useIt(),o.uniform.color(u))}o.uniform.Mmatrix(q.m_matrix);
o.uniform.uAlpha(n);j.normalize=!1;j.type=gl_ctx.FLOAT;j.stride=0;j.offset=0;j.buffer=t;j.numComponents=3;o.attrib.position(j);q.default_meshes?(g||(gl_ctx.bindBuffer(gl_ctx.ELEMENT_ARRAY_BUFFER,object_faces_buffer),gl_ctx.bufferData(gl_ctx.ELEMENT_ARRAY_BUFFER,default_triangle_faces,gl_ctx.STATIC_DRAW),g=!0),1!==p&&1===rendering_mode?gl_ctx.drawElements(gl_ctx.LINE_LOOP,4,gl_ctx.UNSIGNED_SHORT,0):gl_ctx.drawElements(gl_ctx.TRIANGLE_STRIP,4,gl_ctx.UNSIGNED_SHORT,0)):(gl_ctx.bindBuffer(gl_ctx.ELEMENT_ARRAY_BUFFER,
object_faces_buffer),gl_ctx.bufferData(gl_ctx.ELEMENT_ARRAY_BUFFER,q.triangle_faces,gl_ctx.STATIC_DRAW),g=!1,q=q.triangle_faces.length,1!==p&&1===rendering_mode?gl_ctx.drawElements(gl_ctx.LINES,q,gl_ctx.UNSIGNED_SHORT,0):gl_ctx.drawElements(gl_ctx.TRIANGLES,q,gl_ctx.UNSIGNED_SHORT,0));h=o}shadow_buffer&&delete shadow_buffer;shadow_buffer=gl_ctx.createBuffer();for(var e=0;1024>e;e++)gl_stack_for_renter[e]=Array(3);for(e=0;256>e;e++)gl_boundaries_stack[e]=new glMatrixArrayType(4);var f=new Float32Array([0,
0,0,0]),g=!1,h=null,j={},k={},l={};render_ui=function(a,b){if(1!==b&&!GLView.__should_render&&!GLView.__nb_animation)next_rendering_id=vs.requestAnimationFrame(render_ui);else{stats&&stats.begin();calculateViewsInFrustum(a);GLView.__should_render=!1;if(gl_stack_length){gl_ctx.viewport(0,0,frame_size[0]*gl_device_pixel_ratio,frame_size[1]*gl_device_pixel_ratio);gl_ctx.clear(gl_ctx.COLOR_BUFFER_BIT);for(var c=0;c<gl_stack_length;c++){var e=gl_stack_for_renter[c];1===e[0]&&d(e[1],e[2],b)}gl_ctx.flush()}stats&&
stats.end();1!==b&&(next_rendering_id=vs.requestAnimationFrame(render_ui))}};next_rendering_id=vs.requestAnimationFrame(render_ui)}
function handleContextLost(a){console.log("webglcontextlost");a.preventDefault();cancelAnimationFrame(next_rendering_id);delete gl_ctx;gl_ctx=void 0;delete basicShaderProgram;basicShaderProgram=void 0;delete shadowShaderProgram;shadowShaderProgram=void 0;delete imageShaderProgram;imageShaderProgram=void 0;delete oneTextureShaderProgram;oneTextureShaderProgram=void 0;delete twoTexturesShaderProgram;twoTexturesShaderProgram=void 0}function GLConstraint(){}
GLConstraint.prototype={top:null,bottom:null,right:null,left:null,middleX:null,middleY:null,clone:function(){var a=new GLConstraint;this.copy(a);return a},copy:function(a){a.top=this.top;a.bottom=this.bottom;a.right=this.right;a.left=this.left;a.middleX=this.middleX;a.middleY=this.middleY},parseStringStyle:function(a){function b(a,b){return/^@/.test(a)?(a=a.split(" "))&&{identifier:a.shift().substr(1).toLowerCase(),parameters:a.join(" ")}:(b?/:$/:/:/).test(a)?(a=a.split(":"))&&{property:a.shift(),
value:a.join(":")}:a}var c=this;(function(a){for(var c=a.replace(/\/\*[\W\w]*?\*\//g,"").replace(/^\s+|\s+$/g,"").replace(/\s*([:;{}])\s*/g,"$1").replace(/\};+/g,"}").replace(/([^:;{}])}/g,"$1;}"),f=/([^{};]*)([;{}])/g,g=a={block:[]},h;null!=(h=f.exec(c));)"{"==h[2]?g.block.push(g={selector:b(h[1],!0),block:[],parent:g}):"}"==h[2]?g=g.parent:";"==h[2]&&g.block.push(b(h[1]));return a})(a).block.forEach(function(a){var b=util.camelize(a.property),a=parseInt(a.value,10);NaN===a&&(a=null);c[b]=a})},__update_view:function(a){if(a){var b=
a._position[0],c=a._position[1],d=a._size[0],e=a._size[1],f,g,h,j=this.top,k=this.bottom,l=this.right,m=this.left,n=this.middleX,p=this.middleY;if(f=a.__parent)g=f._size[0],h=f._size[1];null===m&&null===n&&null===l||(null!==m&&null===n&&null===l?b=m:null===m&&null!==n&&null===l?g&&(b=(g-d)/2+n):null===m&&null===n&&null!==l?g&&(b=g-(d+l)):null!==m&&null!==n&&null===l?(g&&(d=g-2*m),b=m+n):null!==m&&null===n&&null!==l?(b=m,g&&(d=g-(m+l))):null===m&&null!==n&&null!==l?(g&&(d=g-2*l,b=l),b+=n):null!==m&&
null!==n&&null!==l&&console.log("IMPOSSIBLE CONSTRAINT"));null===j&&null===p&&null===k||(null!==j&&null===p&&null===k?c=j:null===j&&null!==p&&null===k?h&&(c=(h-e)/2+p):null===j&&null===p&&null!==k?h&&(c=h-(e+k)):null!==j&&null!==p&&null===k?(h&&(e=h-2*j),c=j+p):null!==j&&null===p&&null!==k?(c=j,h&&(e=h-(j+k))):null===j&&null!==p&&null!==k?h&&(e=h-2*k,c=k+p):null!==j&&null!==p&&null!==k&&console.log("IMPOSSIBLE CONSTRAINT"));a._position[0]=b;a._position[1]=c;a._size[0]=d;a._size[1]=e}}};
vs.ui.GLConstraint=GLConstraint;function GLColor(a,b,c,d){this.__gl_array=new Float32Array(4);this.setRGBAColor(a,b,c,d)}GLColor.prototype.setRGBAColor=function(a,b,c,d){if(!vs.util.isNumber(a)||0>a||255<a)a=255;if(!vs.util.isNumber(b)||0>b||255<b)b=255;if(!vs.util.isNumber(c)||0>c||255<c)c=255;if(!vs.util.isNumber(d)||0>d||1<d)d=1;a/=255;b/=255;c/=255;this.r=a;this.g=b;this.b=c;this.a=d;this.setColorArray(a,b,c,d)};
GLColor.prototype.setColorArray=function(a,b,c,d){var e=this.__gl_array;e[0]=a;e[1]=b;e[2]=c;e[3]=d};GLColor.prototype.copy=function(a){var b=this.__gl_array,c=a.__gl_array;a.r=this.r;a.g=this.g;a.b=this.b;a.a=this.a;c.set(b)};GLColor.prototype.getRgbaString=function(){return"rgba("+255*this.r+","+255*this.g+","+255*this.b+","+this.a+")"};
GLColor.prototype.setRgbString=function(a){a=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/.exec(a);null!==a&&this.setRGBAColor(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),1)};GLColor.prototype.setRgbaString=function(a){a=/rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(\d?\.\d+)\)/.exec(a);null!==a&&this.setRGBAColor(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4],10))};
function initDefaultColors(){GLColor.transparent=new GLColor(0,0,0,0);GLColor.black=new GLColor(0,0,0,1);GLColor.white=new GLColor(255,255,255,1);GLColor.red=new GLColor(255,0,0,1);GLColor.green=new GLColor(0,255,0,1);GLColor.blue=new GLColor(0,0,255,1);GLColor.yellow=new GLColor(255,255,0,1);GLColor.lightGrey=new GLColor(200,200,200,1);GLColor.default=GLColor.transparent}glAddInitFunction(initDefaultColors);vs.ui.GLColor=GLColor;
function GLStyle(a){this.parent=vs.core.Object;this.parent(a);this.constructor=GLStyle;this._background_image_uv=new Float32Array([0,1,0,0,1,1,1,0]);this._shadow_offset=new Float32Array([0,0]);this._color=GLColor.black;GLStyles.push(this)}var GLStyles=[];
GLStyle.prototype={_opacity:1,_background_color:null,_background_image:null,_background_image_uv:null,_color:null,_font_family:"arial",_font_size:12,_text_align:"left",_text_transform:null,_font_weight:"normal",_shadow_color:null,_shadow_offset:null,_shadow_blur:10,__gl_texture_bck_image:null,__gl_bck_image_uv_buffer:null,destructor:function(){this.__gl_texture_bck_image&&(gl_free_texture_image(this._background_image),this.__gl_texture_bck_image=null);GLStyles.remove(this);core.Object.prototype.destructor.call(this)},
clone:function(){return new GLStyle(this)},copy:function(a){a._opacity=this._opacity;a._font_family=this._font_family;a._font_size=this._font_size;a._text_align=this._text_align;a._text_transform=this._text_transform;this._background_color&&(a._background_color=new GLColor,this._background_color.copy(a._background_color));this._color&&(a._color=new GLColor,this._color.copy(a._color));this._background_image&&(a.backgroundImage=this._background_image);this._background_image_uv&&(a._background_image_uv=
new Float32Array(this._background_image_uv))},parseStringStyle:function(a){function b(a,b){return/^@/.test(a)?(a=a.split(" "))&&{identifier:a.shift().substr(1).toLowerCase(),parameters:a.join(" ")}:(b?/:$/:/:/).test(a)?(a=a.split(":"))&&{property:a.shift(),value:a.join(":")}:a}var c=this;(function(a){for(var c=a.replace(/\/\*[\W\w]*?\*\//g,"").replace(/^\s+|\s+$/g,"").replace(/\s*([:;{}])\s*/g,"$1").replace(/\};+/g,"}").replace(/([^:;{}])}/g,"$1;}"),f=/([^{};]*)([;{}])/g,g=a={block:[]},h;null!=(h=
f.exec(c));)"{"==h[2]?g.block.push(g={selector:b(h[1],!0),block:[],parent:g}):"}"==h[2]?g=g.parent:";"==h[2]&&g.block.push(b(h[1]));return a})(a).block.forEach(function(a){var b=util.camelize(a.property),a=a.value;switch(b){case "backgroundColor":case "color":var f;GLColor[a]?f=GLColor[a]:0===a.indexOf("rgb(")?(f=new GLColor,f.setRgbString(a)):0===a.indexOf("rgba(")?(f=new GLColor,f.setRgbaString(a)):f=new GLColor(a);c[b]=f;break;case "fontFamily":case "fontSize":case "textAlign":case "textWeight":c[b]=
a}})}};
vs.util.defineClassProperties(GLStyle,{opacity:{set:function(a){if(util.isNumber(a)&&!(0>a||1<a))this._opacity=a,GLView.__should_render=!0},get:function(){return this._opacity}},backgroundColor:{set:function(a){a instanceof GLColor&&(this._background_color=a,GLView.__should_render=!0)},get:function(){return this._background_color}},color:{set:function(a){a instanceof GLColor&&(this._color=a,GLView.__should_render=!0)},get:function(){return this._color}},fontFamily:{set:function(a){util.isString(a)&&(this._font_family=
a,GLView.__should_render=!0)},get:function(){return this._font_family}},fontSize:{set:function(a){util.isString(a)&&(a=parseInt(a,10));util.isNumber(a)&&(this._font_size=a,GLView.__should_render=!0)},get:function(){return this._font_size}},fontWeight:{set:function(a){"normal"!=a&&"bold"!=a&&"bolder"!=a&&"lighter"!=a&&"100"!=a&&"200"!=a&&"300"!=a&&"400"!=a&&"500"!=a&&"600"!=a&&"700"!=a&&"800"!=a&&"900"!=a||(this._font_weight=a,GLView.__should_render=!0)},get:function(){return this._font_weight}},textAlign:{set:function(a){util.isString(a)&&
(this._text_align=a,GLView.__should_render=!0)},get:function(){return this._text_align}},textTransform:{set:function(a){util.isString(a)&&(this._text_transform=a,GLView.__should_render=!0)},get:function(){return this._text_transform}},backgroundImage:{set:function(a){if(util.isString(a)){if(this._background_image=a){var b=this;gl_get_texture_from_image_url(b._background_image,function(a){b.__gl_texture_bck_image=a})}else this.__gl_texture_bck_image&&(gl_free_texture_image(this._background_image),
this.__gl_texture_bck_image=null);GLView.__should_render=!0}},get:function(){return this._background_image}},shadowColor:{set:function(a){a instanceof GLColor&&(this._shadow_color=a,GLView.__should_render=!0)},get:function(){return this._shadow_color}},shadowOffset:{set:function(a){util.isArray(a)&&2===a.length&&(this._shadow_offset[0]=a[0],this._shadow_offset[1]=a[0],GLView.__should_render=!0)},get:function(){return this._shadow_offset}},shadowBlur:{set:function(a){util.isNumber(a)&&(this._shadow_blur=
a,GLView.__should_render=!0)},get:function(){return this._shadow_blur}},backgroundImageUV:{set:function(a){a&&util.isArray(a)&&8==a.length&&util.isNumber(a[0])&&util.isNumber(a[1])&&util.isNumber(a[2])&&util.isNumber(a[3])&&util.isNumber(a[4])&&util.isNumber(a[5])&&util.isNumber(a[6])&&util.isNumber(a[7])&&(this._background_image_uv=new Float32Array(a),GLView.__should_render=!0)},get:function(){return this._background_image_uv}}});var _default_style;
function initDefaultStyle(){_default_style=new GLStyle;_default_style.backgroundColor=GLColor.default;_default_style.color=GLColor.black}glAddInitFunction(initDefaultStyle);GLStyle.restoreGLContext=function(){for(var a,b=0,c=GLStyles.length;b<c;b++)if((a=GLStyles[b])&&a.__gl_texture_bck_image)delete a.__gl_texture_bck_image,a.__gl_texture_bck_image=gl_ctx.createTexture()};vs.ui.GLStyle=GLStyle;
function GLEventSource(a){this.parent=VSObject;this.parent(a);this.constructor=core.GLEventSource;this.__bindings__={};this._pointer_start=[];this._pointer_move=[];this._pointer_end=[]}
GLEventSource.prototype={__bindings__:null,destructor:function(){for(var a in this.__bindings__){var b=this.__bindings__[a];if(b)for(var c=void 0,d=b.length;d--;)c=b[d],Handler.release(c);delete this.__bindings__[a]}delete this.__bindings__;VSObject.prototype.destructor.call(this)},_pointer_start:null,_pointer_move:null,_pointer_end:null,addEventListener:function(a,b){a===vs.POINTER_START?(this._pointer_start.push(b),__gl_activate_pointer_start()):a===vs.POINTER_MOVE?(this._pointer_move.push(b),__gl_activate_pointer_move()):
a===vs.POINTER_END?(this._pointer_end.push(b),__gl_activate_pointer_end()):"webglcontextrestored"===a&&register_webglcontextrestored(this,b)},removeEventListener:function(a,b){a===vs.POINTER_START?(this._pointer_start.remove(b),__gl_deactivate_pointer_start()):a===vs.POINTER_MOVE?(this._pointer_move.remove(b),__gl_deactivate_pointer_move()):a===vs.POINTER_END&&(this._pointer_end.remove(b),__gl_deactivate_pointer_end())},_clone:function(a,b){VSObject.prototype._clone.call(this,a,b);a.__bindings__=
{}},bind:function(a,b,c){if(a&&b){var d=Handler.retain(),e=this.__bindings__[a];d.configure(b,c);e||(e=[],this.__bindings__[a]=e);e.push(d);return d}},unbind:function(a,b,c){if(a=this.__bindings__[a])for(var d,e=0;e<a.length;)d=a[e],d.obj===b?util.isString(c)||util.isFunction(c)?d.func_name===c||d.func_ptr===c?(a.remove(e),Handler.release(d)):e++:(a.remove(e),Handler.release(d)):e++},propagate:function(a,b,c){var d=this.__bindings__[a];!d||0===d.length?this.__parent&&(c||(c=this),this.__parent.propagate(a,
b,c)):(a=new vs.core.Event(this,a,b),c&&(a.srcTarget=c),queueProcAsyncEvent(a,d))},notify:function(a){this.propagate(a.type,a.data)}};util.extendClass(GLEventSource,VSObject);core.GLEventSource=GLEventSource;var rttFramebuffer,rttTexture;
function initPickBuffer(){rttFramebuffer=gl_ctx.createFramebuffer();gl_ctx.bindFramebuffer(gl_ctx.FRAMEBUFFER,rttFramebuffer);rttFramebuffer.width=frame_size[0]*gl_device_pixel_ratio;rttFramebuffer.height=frame_size[1]*gl_device_pixel_ratio;rttTexture=gl_ctx.createTexture();gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,rttTexture);gl_ctx.texImage2D(gl_ctx.TEXTURE_2D,0,gl_ctx.RGBA,rttFramebuffer.width,rttFramebuffer.height,0,gl_ctx.RGBA,gl_ctx.UNSIGNED_BYTE,null);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,rttTexture);
gl_ctx.texImage2D(gl_ctx.TEXTURE_2D,0,gl_ctx.RGBA,rttFramebuffer.width,rttFramebuffer.height,0,gl_ctx.RGBA,gl_ctx.UNSIGNED_BYTE,null);0!==frame_size[0]*gl_device_pixel_ratio&&0===(frame_size[0]*gl_device_pixel_ratio&frame_size[0]*gl_device_pixel_ratio-1)&&0!==frame_size[1]*gl_device_pixel_ratio&&0===(frame_size[1]*gl_device_pixel_ratio&frame_size[1]*gl_device_pixel_ratio-1)?(gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_MAG_FILTER,gl_ctx.LINEAR),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_MIN_FILTER,
gl_ctx.NEAREST_MIPMAP_LINEAR),gl_ctx.generateMipmap(gl_ctx.TEXTURE_2D)):(gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_MIN_FILTER,gl_ctx.LINEAR),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_WRAP_S,gl_ctx.CLAMP_TO_EDGE),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_WRAP_T,gl_ctx.CLAMP_TO_EDGE));var a=gl_ctx.createRenderbuffer();gl_ctx.bindRenderbuffer(gl_ctx.RENDERBUFFER,a);gl_ctx.renderbufferStorage(gl_ctx.RENDERBUFFER,gl_ctx.DEPTH_COMPONENT16,rttFramebuffer.width,rttFramebuffer.height);
gl_ctx.framebufferTexture2D(gl_ctx.FRAMEBUFFER,gl_ctx.COLOR_ATTACHMENT0,gl_ctx.TEXTURE_2D,rttTexture,0);gl_ctx.framebufferRenderbuffer(gl_ctx.FRAMEBUFFER,gl_ctx.DEPTH_ATTACHMENT,gl_ctx.RENDERBUFFER,a);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,null);gl_ctx.bindRenderbuffer(gl_ctx.RENDERBUFFER,null);gl_ctx.bindFramebuffer(gl_ctx.FRAMEBUFFER,null)}
function pickUp(a){if(render_ui&&a&&gl_ctx&&!gl_ctx.isContextLost()){var b=a.clientX,c=a.clientY;if(vs.util.isUndefined(b)||vs.util.isUndefined(c)){b=a.targetPointerList;b||(b=a.targetTouches);b||(b=a.touches);if(!b||0===b.length)return;a=b[0];b=a.clientX;c=a.clientY}return _pickUp(b*gl_device_pixel_ratio,c*gl_device_pixel_ratio)}}var pickUp_pixelColor=new Uint8Array(4);
function _pickUp(a,b){DropTick=1;gl_ctx.bindFramebuffer(gl_ctx.FRAMEBUFFER,rttFramebuffer);gl_ctx.clearColor(1,1,1,1);render_ui(performance.now(),1);b=frame_size[1]*gl_device_pixel_ratio-b;gl_ctx.readPixels(a,b,1,1,gl_ctx.RGBA,gl_ctx.UNSIGNED_BYTE,pickUp_pixelColor);gl_ctx.clearColor(1,1,1,1);gl_ctx.bindFramebuffer(gl_ctx.FRAMEBUFFER,null);return GL_VIEWS[pickUp_pixelColor[0]+256*pickUp_pixelColor[1]+65536*pickUp_pixelColor[2]]}var __pointer_start_activated=0;
function __gl_activate_pointer_start(){0===__pointer_start_activated&&GL_CANVAS.addEventListener(POINTER_START,pointer_start);__pointer_start_activated++}function __gl_deactivate_pointer_start(){0!==__pointer_start_activated&&(1===__pointer_start_activated&&GL_CANVAS.removeEventListener(POINTER_START,pointer_start),__pointer_start_activated--)}var __pointer_move_activated=0;
function __gl_activate_pointer_move(){0===__pointer_move_activated&&GL_CANVAS.addEventListener(POINTER_MOVE,pointer_move);__pointer_move_activated++}function __gl_deactivate_pointer_move(){0!==__pointer_move_activated&&(1===__pointer_move_activated&&GL_CANVAS.removeEventListener(POINTER_MOVE,pointer_move),__pointer_move_activated--)}var __pointer_end_activated=0;
function __gl_activate_pointer_end(){0===__pointer_end_activated&&GL_CANVAS.addEventListener(POINTER_END,pointer_end);__pointer_end_activated++}function __gl_deactivate_pointer_end(){0!==__pointer_end_activated&&(1===__pointer_end_activated&&GL_CANVAS.removeEventListener(POINTER_END,pointer_end),__pointer_end_activated--)}function pointer_start(a){var b=pickUp(a);b&&dispatch_event(POINTER_START,b,a)}function pointer_move(a){var b=pickUp(a);b&&dispatch_event(POINTER_MOVE,b,a)}
function pointer_end(a){var b=pickUp(a);b&&dispatch_event(POINTER_END,b,a)}var MOUSE_PROPS="bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget,pageX,pageY".split(","),MOUSE_DEFAULTS=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function GLEvent(){this.path=[]}
GLEvent.prototype.init=function(a,b,c){this.bubbles=b||!1;this.cancelBubble=!1;this.cancelable=c||!1;this.clipboardData=void 0;this.currentTarget=null;this.defaultPrevented=!1;this.eventPhase=0;this.path.length=0;this.returnValue=!0;this.target=this.srcElement=null;this.timeStamp=Date.now();this.type=a||""};GLEvent.prototype.setSrcElement=function(a){for(this.currentTarget=this.target=this.srcElement=a;a;)this.path.push(a),a=a.__parent};
GLEvent.prototype.setTarget=function(a){this.currentTarget=this.target=a};GLEvent.prototype.preventDefault=function(){this.defaultPrevented=!0};function GLPointerEvent(a,b,c){GLEvent.call(this);this.pointerList=[];this.targetPointerList=[];this.changedPointerList=[];this.init(a,b,c)}util.extendClass(GLPointerEvent,GLEvent);var defaultInDict=Object.create(null);
GLPointerEvent.prototype.init=function(a,b,c){b=b||defaultInDict;GLEvent.prototype.init.call(this,a,b.bubbles||!1,b.cancelable||!1);var a=0,d=MOUSE_PROPS.length;this.setSrcElement(c);for(this.setTarget(c);a<d;a++)c=MOUSE_PROPS[a],this[c]=b[c]||MOUSE_DEFAULTS[a];this.buttons=b.buttons||0;c=0;c=b.pressure?b.pressure:this.buttons?0.5:0;this.x=this.clientX;this.y=this.clientY;this.pointerId=b.pointerId||0;this.width=b.width||0;this.height=b.height||0;this.pressure=c;this.tiltX=b.tiltX||0;this.tiltY=b.tiltY||
0;this.pointerType=b.pointerType||"";this.hwTimestamp=b.hwTimestamp||0;this.isPrimary=b.isPrimary||!1;this.nbPointers=0;this.pointerList.length=0;this.targetPointerList.length=0;this.changedPointerList.length=0};GLPointerEvent.prototype.setSrcElement=function(a){function b(b){for(var d=0,e=b.length,f;d<e;d++)f=b[d],f.srcElement=a}GLEvent.prototype.setSrcElement.call(this,a);b(this.pointerList);b(this.targetPointerList);b(this.changedPointerList)};
GLPointerEvent.prototype.setTarget=function(a){function b(b){for(var d=0,e=b.length,f;d<e;d++)f=b[d],f.target=a,f.currentTarget=a}GLEvent.prototype.setTarget.call(this,a);b(this.pointerList);b(this.targetPointerList);b(this.changedPointerList)};function Pointer(a){this.identifier=a}
Pointer.prototype.configure=function(a,b,c,d,e){this.pageX=a.pageX;this.pageY=a.pageY;this.clientX=void 0!==d?d:a.clientX;this.clientY=void 0!==e?e:a.clientY;this.srcElement=b?b:a.srcElement;this.target=c?c:a.target;this.currentTarget=c?c:a.currentTarget};Pointer._pointers=[];Pointer.getPointer=function(a){var b=Pointer._pointers[a];b||(b=new Pointer(a),Pointer._pointers[a]=b);return b};
function setupMousePointerEvent(){POINTER_START="mousedown";POINTER_MOVE="mousemove";POINTER_END="mouseup";POINTER_CANCEL=null;var a=new GLPointerEvent;buildEvent=function(b,c,d){a.init(b,c,d);var c=a.targetPointerList,e=Pointer.getPointer(31337);e.configure(a,d,d);c.push(e);b===POINTER_END||b==POINTER_CANCEL?(a.nbPointers=1,a.changedPointerList=c):(a.nbPointers=0,a.pointerList=c);return a}}
function setupTouchEvent(){POINTER_START="touchstart";POINTER_MOVE="touchmove";POINTER_END="touchend";POINTER_CANCEL="touchcancel";var a=[],b=new GLPointerEvent;buildEvent=function(c,d,e,f){var g;b.init(c,d,e);b.nbPointers=d.touches.length;for(var h=b.pointerList,j=0;j<b.nbPointers;j++)c=d.touches[j],g=Pointer.getPointer(c.identifier),g.configure(c,e,e),h.push(g);h=b.targetPointerList;for(j=0;j<d.targetTouches.length;j++)c=d.targetTouches[j],f&&a[c.identifier]!=f||(g=Pointer.getPointer(c.identifier),
g.configure(c,e,e,PointerTypes.TOUCH),h.push(g));h=b.changedPointerList;for(j=0;j<d.changedTouches.length;j++)c=d.changedTouches[j],g=Pointer.getPointer(c.identifier),g.configure(c,e,e,PointerTypes.TOUCH),h.push(g);return b}}var EVENT_SUPPORT_TOUCH=!1,EVENT_SUPPORT_GESTURE=!1,hasPointer=window.navigator.pointerEnabled,hasMSPointer=window.navigator.msPointerEnabled;
if("undefined"!=typeof document&&"createTouch"in document)EVENT_SUPPORT_TOUCH=!0;else if(hasPointer||hasMSPointer)EVENT_SUPPORT_TOUCH=!0;else if("undefined"!=typeof document&&window.navigator&&window.navigator.userAgent&&(-1!==window.navigator.userAgent.indexOf("Android")||-1!==window.navigator.userAgent.indexOf("BlackBerry")))EVENT_SUPPORT_TOUCH=!0;var PointerTypes={TOUCH:2,PEN:3,MOUSE:4},POINTER_START,POINTER_MOVE,POINTER_END,POINTER_CANCEL,buildEvent;EVENT_SUPPORT_TOUCH?setupTouchEvent():setupMousePointerEvent();
function getBindingIndex(a,b,c){if(!b||!c||!c.__event_listeners)return-1;for(var d=0;d<c.__event_listeners.length;d++){var e=c.__event_listeners[d];if(e.target===a&&e.type===b&&e.listener===c)return d}return-1}
function addPointerListener(a,b,c,d){if(b&&a)if(c){var e=c;util.isFunction(c)||(e=c.handleEvent,util.isFunction(e)&&(e=e.bind(c)));if(-1!==getBindingIndex(a,b,c))console.error("addPointerListener binding already existing");else{c.__event_listeners||(c.__event_listeners=[]);var f={target:a,type:b,listener:c};c.__event_listeners.push(f);f.handler=e;a instanceof GLView?a.addEventListener(b,f.handler,d):a instanceof Document?(f.doc_handler=function(c){c=buildEvent(b,c,a);vs.util.isFunction(f.handler)?
f.handler.call(a,c):vs.util.isFunction(f.handler.handleEvent)&&f.handler.handleEvent.call(f.handler,c)},a.addEventListener(b,f.doc_handler,d)):a instanceof HTMLElement&&(f.node_handler=function(c){c=buildEvent(b,c,a);vs.util.isFunction(f.handler)?f.handler.call(a,c):vs.util.isFunction(f.handler.handleEvent)&&f.handler.handleEvent.call(f.handler,c)},a.addEventListener(b,f.node_handler,d))}}else console.error("addPointerListener no listener")}
function removePointerListener(a,b,c,d){if(b&&a)if(c){var e=getBindingIndex(a,b,c);if(-1===e)console.error("removePointerListener no binding");else{var f=c.__event_listeners[e];c.__event_listeners.remove(e);a instanceof GLView?a.removeEventListener(b,f.handler,d):a instanceof HTMLElement?a.removeEventListener(b,f.node_handler,d):a instanceof Document&&a.removeEventListener(b,f.doc_handler,d);delete f}}else console.error("removePointerListener no listener")}
function _dispatch_event(a,b,c){c.currentTarget=a;b.forEach(function(b){vs.util.isFunction(b)?b.call(a,c):vs.util.isFunction(b.handleEvent)&&b.handleEvent.call(b,c)})}function dispatch_event(a,b,c){var d;if(a===POINTER_START)d="_pointer_start";else if(a===POINTER_MOVE)d="_pointer_move";else if(a===POINTER_END||a===POINTER_END)d="_pointer_end";var a=buildEvent(a,c,b),c=a.path,e;for(i=0;i<c.length;i++)if(b=c[i],(e=b[d])&&e.length)a.setTarget(b),_dispatch_event(b,e,a)}vs.removePointerListener=removePointerListener;
vs.addPointerListener=addPointerListener;vs.PointerTypes=PointerTypes;vs.POINTER_START=POINTER_START;vs.POINTER_MOVE=POINTER_MOVE;vs.POINTER_END=POINTER_END;vs.POINTER_CANCEL=POINTER_CANCEL;
function GLView(a){this.parent=GLEventSource;this.parent(a);this.constructor=GLView;this.__pointer_recognizers=[];this.__children=[];this.view=this;this._position=vec3.create();this._size=vec2.create();this._rotation=vec3.create();this._translation=vec3.create();this._transform_origin=vec2.create();createSprite(this)}GLView.__should_render=!0;GLView.__nb_animation=0;GLView._positionStyle=void 0;var _template_nodes=null;
GLView.prototype={__invalid_matrixes:!0,_visible:!0,_enable:!0,_position:null,_size:null,_scaling:1,_rotation:null,_translation:null,_constraint:null,_style:null,_transform_origin:null,destructor:function(){var a,b;this.__parent&&this.__parent.remove(this);for(a=0;a<this.__children.length;a++)b=this.__children[a],util.free(b);delete this.__children;this.clearTransformStack();deleteSprite(this);GLEventSource.prototype.destructor.call(this)},refresh:function(){this._updateSizeAndPos();for(var a=0,b=
this.__children.length,c;a<b;a++)(c=this.__children[a])&&c.refresh&&c.refresh()},initComponent:function(){GLEventSource.prototype.initComponent.call(this);this._style=new GLStyle;this._constraint=null;this.__config__||(this.__config__={});this.__config__.id=this.id;this._position[0]=0;this._position[1]=0;this._position[2]=0;this._size[0]=0;this._size[1]=0;this._transform_origin[0]=0;this._transform_origin[1]=0;this._rotation[0]=0;this._rotation[1]=0;this._rotation[2]=0;this._translation[0]=0;this._translation[1]=
0;this._translation[2]=0;this.__should_update_gl_matrix=this.__should_update_gl_vertices=!0;initSprite(this)},viewDidAdd:function(){this._updateSizeAndPos()},notify:function(){},setUdpateVerticesFunction:function(a){setUpdateVerticesSprite(this,a)},setShadersProgram:function(a){setShadersProgram(this,a)},setVerticesAllocationFunctions:function(a,b,c,d,e){setVerticesAllocationFunctions(this,a,b,c,d,e)},createAndAddComponent:function(a,b,c){var d=window[a];if(d){b||(b={});b.id||(b.id=core.createId());
var e;e=null;try{e=new d(b)}catch(f){a="Impossible to instanciate comp: "+a+(" => "+f.message);console.error(a);f.stack&&console.error(f.stack);return}try{e.init(),e.configure(b)}catch(g){g.line&&g.sourceURL?(a="Error when initiate comp: "+a+(" => "+g.message),a+="\n"+g.sourceURL+":"+g.line):a=g,console.error(a),g.stack&&console.error(g.stack)}this.add(e,c);e.refresh();return e}console.error("Impossible to fund component '"+a+"'.")},isChild:function(a){return!a?!1:-1!==this.__children.indexOf(a)?
!0:!1},add:function(a){a&&!this.isChild(a)&&(this.__children.push(a),a.__parent=this,this.__i__&&a.__i__&&a.viewDidAdd&&a.viewDidAdd(),vs.scheduleAction(function(){GLView.__should_render=!0}))},remove:function(a){a&&this.isChild(a)&&(this.__children.remove(a),a.__parent=null,vs.scheduleAction(function(){GLView.__should_render=!0}))},removeAllChildren:function(a){for(var b,c=[];this.__children.length;)b=this.__children[0],this.remove(b),a?util.free(b):c.push(b);return a?void 0:c},_updateSizeAndPos:function(){this._constraint&&
this._constraint.__update_view(this);this.__should_update_gl_matrix=this.__should_update_gl_vertices=!0},redraw:function(){this._updateSizeAndPos()},show:function(a){this._visible||(util.isFunction(a)||(a=void 0),this.__is_hidding=!1,this.__is_showing=!0,this._show_object(a))},_show_object:function(a){vs.scheduleAction(function(){GLView.__should_render=!0});this.__visibility_anim=void 0;if(this.__is_showing){this.__is_showing=!1;this._visible=!0;var b=this;this.propertyChange();a&&a&&vs.scheduleAction(function(){a.call(b)})}},
_clone:function(a,b){GLEventSource.prototype._clone.call(this,a,b);this._style&&(a._style?this._style.copy(a._style):a.style=this._style.clone());a.__parent=void 0;this.__children.forEach(function(c){var d=c.clone();b[c._id]=d;a.add(d)})},hide:function(a){if(this._visible||this.__is_showing)util.isFunction(a)||(a=void 0),this.__is_showing=this._visible=!1,this.__is_hidding=!0,this._hide_object(a)},_hide_object:function(a){vs.scheduleAction(function(){GLView.__should_render=!0});this._visible||(this.__visibility_anim=
void 0,this.__is_hidding&&(this.__is_hidding=!1,a&&a&&vs.scheduleAction(function(){a.call(self)}),this.propertyChange()))},_propagateToParent:function(a){this.__parent&&(this.__parent.handleEvent&&(to_propatate=this.__parent.handleEvent(a)),to_propatate&&this.__parent._propagateToParent(a))},notifyToParent:function(a){this.__parent&&(this.__parent.handleEvent?this.__parent.handleEvent(a):this.__parent.notify&&this.__parent.notify(a))},_didEnable:function(){},_clone_properties_value:function(a,b){for(var c in this)"id"==
c||"view"==c||"__parent"==c||"style"==c||"_style"==c||(this.isProperty(c)?vs.core.Object.__propertyCloneValue(c,this,a):this[c]instanceof GLView&&(a[c]=b[this[c]._id]))}};util.extend(GLView.prototype,vs.ui.RecognizerManager);util.extendClass(GLView,GLEventSource);
util.defineClassProperties(GLView,{size:{set:function(a){if(!(!util.isArray(a)&&!(a instanceof Float32Array)||2!==a.length)&&util.isNumber(a[0])&&util.isNumber(a[1]))this._size[0]=a[0],this._size[1]=a[1],this._updateSizeAndPos()},get:function(){return this._size}},position:{set:function(a){if(a&&!(!util.isArray(a)&&!(a instanceof Float32Array)||2!=a.length&&3!=a.length)&&util.isNumber(a[0])&&util.isNumber(a[1]))util.isNumber(a[2])||(a[2]=0),vec3.set(a,this._position),this._updateSizeAndPos()},get:function(){return this._position}},
visible:{set:function(a){a?this.show():this.hide()},get:function(){return this._visible}},enable:{set:function(a){a&&!this._enable?(this._enable=!0,this._didEnable()):!a&&this._enable&&(this._enable=!1,this._didEnable());GLView.__should_render=!0},get:function(){return this._enable}},translation:{set:function(a){this._translation[0]=a[0];this._translation[1]=a[1];this._translation[2]=a[2]||0;this.__should_update_gl_matrix=!0;GLView.__should_render=!0},get:function(){return this._translation}},rotation:{set:function(a){this._rotation[0]=
a[0]||0;this._rotation[1]=a[1]||0;this._rotation[2]=a[2]||0;this.__should_update_gl_matrix=!0;GLView.__should_render=!0},get:function(){return this._rotation}},scaling:{set:function(a){this._scaling=a;this.__should_update_gl_matrix=!0;GLView.__should_render=!0},get:function(){return this._scaling}},opacity:{set:function(a){this._style.opacity=a;GLView.__should_render=!0},get:function(){return this._style.opacity}},transformOrigin:{set:function(a){if(!(!util.isArray(a)&&!(a instanceof Float32Array)||
2!==a.length)&&util.isNumber(a[0])&&util.isNumber(a[1]))this._transform_origin[0]=a[0],this._transform_origin[1]=a[1],GLView.__should_render=!0},get:function(){return this._transform_origin}},style:{set:function(a){a instanceof GLStyle&&(this._style=a,GLView.__should_render=!0)},get:function(){return this._style}},constraint:{set:function(a){a instanceof GLConstraint&&(this._constraint&&delete this._constraint,this._constraint=a,GLView.__should_render=!0)},get:function(){this._constraint||(this._constraint=
new GLConstraint);return this._constraint}}});vs.ui.GLView=GLView;function GLScrollView(a){this.parent=GLView;this.parent(a);this.constructor=GLScrollView;this.__gl_scroll=vec3.create()}
GLScrollView.prototype={_scroll:!1,_pinch:vs.ui.ScrollView.NO_PINCH,__gl_scroll:null,refresh:function(){GLView.prototype.refresh.call(this);this.__scroll__&&this.__scroll__.refresh()},destructor:function(){this._remove_scroll();this._scroll=!1;GLView.prototype.destructor.call(this)},initComponent:function(){GLView.prototype.initComponent.call(this);this.pinch=this._pinch;this.scroll=this._scroll;this.layout=this._layout;this.refresh()},handleEvent:function(a){return this.__scroll__?(this.__scroll__.handleEvent(a),
!1):!0},_updateSize:function(){GLView.prototype._updateSize.call(this);this.refresh()},_setup_scroll:function(){this._remove_scroll();var a={scrollY:!1,scrollX:!1};this._scroll===vs.ui.ScrollView.VERTICAL_SCROLL?a.scrollY=!0:this._scroll===vs.ui.ScrollView.HORIZONTAL_SCROLL?a.scrollX=!0:this._scroll===vs.ui.ScrollView.SCROLL&&(a.scrollX=!0,a.scrollY=!0);this.__scroll__=new GLScrollView.__iscroll(this,a);this.refresh()},__gl_update_scroll:function(a){this.__scroll__&&this.__scroll__.__gl_update_scroll(a)},
_remove_scroll:function(){this.__scroll__&&(this.__scroll__.destroy(),delete this.__scroll__,this.__scroll__=void 0)}};util.extendClass(GLScrollView,GLView);
util.defineClassProperties(GLScrollView,{scroll:{set:function(a){if(a!==this._scroll)if(a){if(!0===a||1===a||2===a||3===a)this._scroll=a,this._setup_scroll()}else this._scroll=!1,this._remove_scroll()},get:function(){return this._scroll}},pinch:{set:function(a){!(a!==vs.ui.ScrollView.NO_PINCH&&a!==vs.ui.ScrollView.ROTATION&&a!==vs.ui.ScrollView.SCALE&&a!==vs.ui.ScrollView.ROTATION_AND_SCALE)&&this.view&&(this._pinch=a)}}});ui.GLScrollView=GLScrollView;
(function(a,b){function c(a,b){this.wrapper=a;this.options={startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,preventDefault:!0};for(var c in b)this.options[c]=b[c];this.options.eventPassthrough=!0===this.options.eventPassthrough?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY;this.options.scrollX=
"horizontal"==this.options.eventPassthrough?!1:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=e;this.pos=this.wrapper.__gl_scroll;this.directionY=this.directionX=0;this._events={};this.wrapper.addEventListener(vs.POINTER_START,this);this.refresh();this.enable()}var d=function(a){return a*(2-a)},e=function(a){return b.sqrt(1-
--a*a)},f=function(a,c,d,e,f,m){var c=a-c,d=b.abs(c)/d,n,m=void 0===m?6.0E-4:m;n=a+d*d/(2*m)*(0>c?-1:1);m=d/m;n<e?(n=f?e-f/2.5*(d/8):e,c=b.abs(n-a),m=c/d):0<n&&(n=f?f/2.5*(d/8):0,c=b.abs(a)+n,m=c/d);return{destination:b.round(n),duration:m}};c.prototype={version:"5.1.1",destroy:function(){this.wrapper.removeEventListener(vs.POINTER_START,this)},_start:function(a){this.enabled&&(a=a.targetPointerList?a.targetPointerList[0]:a,this.moved=!1,this.directionLocked=this.directionY=this.directionX=this.distY=
this.distX=0,this.startTime=performance.now(),this.isInTransition?(this.isInTransition=!1,this.isAnimating&&(GLView.__nb_animation--,this.isAnimating=!1,this.wrapper.__is_scrolling=!1),this._translate(b.round(this.pos[0]),b.round(this.pos[1])),this._execEvent("scrollEnd")):this.isAnimating&&(this.isAnimating=!1,GLView.__nb_animation--,this.wrapper.__is_scrolling=!1,this._execEvent("scrollEnd")),this.startX=this.pos[0],this.startY=this.pos[1],this.absStartX=this.pos[0],this.absStartY=this.pos[1],this.pointX=
a.pageX,this.pointY=a.pageY,this._execEvent("beforeScrollStart"),vs.addPointerListener(document,vs.POINTER_MOVE,this),vs.addPointerListener(document,vs.POINTER_CANCEL,this),vs.addPointerListener(document,vs.POINTER_END,this),this._tap=!0)},_move:function(a){if(this.enabled){this.options.preventDefault&&a.preventDefault();var c=a.targetPointerList?a.targetPointerList[0]:a,d=c.pageX-this.pointX,e=c.pageY-this.pointY,f=performance.now(),m;this.pointX=c.pageX;this.pointY=c.pageY;this.distX+=d;this.distY+=
e;c=b.abs(this.distX);m=b.abs(this.distY);if(this._tap&&(5<b.abs(this.distX)||5<b.abs(this.distY)))this._tap=!1;if(!(300<f-this.endTime&&10>c&&10>m)){!this.directionLocked&&!this.options.freeScroll&&(this.directionLocked=c>m+this.options.directionLockThreshold?"h":m>=c+this.options.directionLockThreshold?"v":"n");if("h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)a.preventDefault();else if("horizontal"==this.options.eventPassthrough)return;e=0}else if("v"==this.directionLocked){if("horizontal"==
this.options.eventPassthrough)a.preventDefault();else if("vertical"==this.options.eventPassthrough)return;d=0}d=this.hasHorizontalScroll?d:0;e=this.hasVerticalScroll?e:0;a=this.pos[0]+d;c=this.pos[1]+e;if(0<a||a<this.maxScrollX)a=this.options.bounce?this.pos[0]+d/3:0<a?0:this.maxScrollX;if(0<c||c<this.maxScrollY)c=this.options.bounce?this.pos[1]+e/3:0<c?0:this.maxScrollY;this.directionX=0<d?-1:0>d?1:0;this.directionY=0<e?-1:0>e?1:0;this.moved||this._execEvent("scrollStart");this.moved=!0;this._translate(a,
c);300<f-this.startTime&&(this.startTime=f,this.startX=this.pos[0],this.startY=this.pos[1])}}},_end:function(){if(this.enabled){vs.removePointerListener(document,vs.POINTER_MOVE,this);vs.removePointerListener(document,vs.POINTER_CANCEL,this);vs.removePointerListener(document,vs.POINTER_END,this);var a,c;c=performance.now()-this.startTime;var e=b.round(this.pos[0]),k=b.round(this.pos[1]);a=b.abs(e-this.startX);var l=b.abs(k-this.startY),m=0,n="";this.isInTransition=0;this.endTime=performance.now();
if(!this.resetPosition(this.options.bounceTime))if(this.scrollTo(e,k),this.moved)if(this._events.flick&&200>c&&100>a&&100>l)this._execEvent("flick");else if(this.options.momentum&&300>c&&(a=this.hasHorizontalScroll?f(this.pos[0],this.startX,c,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:e,duration:0},c=this.hasVerticalScroll?f(this.pos[1],this.startY,c,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:k,
duration:0},e=a.destination,k=c.destination,m=b.max(a.duration,c.duration),this.isInTransition=1),e!=this.pos[0]||k!=this.pos[1]){if(0<e||e<this.maxScrollX||0<k||k<this.maxScrollY)n=d;this.scrollTo(e,k,m,n)}else this._execEvent("scrollEnd");else this._execEvent("scrollCancel")}},resetPosition:function(a){var b=this.pos[0],c=this.pos[1];!this.hasHorizontalScroll||0<this.pos[0]?b=0:this.pos[0]<this.maxScrollX&&(b=this.maxScrollX);!this.hasVerticalScroll||0<this.pos[1]?c=0:this.pos[1]<this.maxScrollY&&
(c=this.maxScrollY);if(b==this.pos[0]&&c==this.pos[1])return!1;this.scrollTo(b,c,a||0,this.options.bounceEasing);return!0},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapperWidth=this.wrapper._size[0];this.wrapperHeight=this.wrapper._size[1];this.scrollerHeight=this.scrollerWidth=0;var a=this.wrapper.__children;if(a){for(var b=0,c=0,d=0,e=a.length,f,n;d<e;d++)f=a[d],n=f._position,f=f._size,n[0]+f[0]>b&&(b=n[0]+f[0]),n[1]+f[1]>c&&(c=n[1]+f[1]);this.scrollerWidth=
b;this.scrollerHeight=c}this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&0>this.maxScrollX;this.hasVerticalScroll=this.options.scrollY&&0>this.maxScrollY;this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth);this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight);this.directionY=this.directionX=this.endTime=0;this._execEvent("refresh");this.resetPosition()},
_execEvent:function(a){if(this._events[a]){var b=0,c=this._events[a].length;if(c)for(;b<c;b++)this._events[a][b].apply(this,[].slice.call(arguments,1))}},scrollBy:function(a,b,c,d){a=this.pos[0]+a;b=this.pos[1]+b;this.scrollTo(a,b,c||0,d)},scrollTo:function(a,b,c,d){d=d||e;this.isInTransition=0<c;c?this._animate(a,b,c,d):this._translate(a,b)},_translate:function(a,b){this.pos[0]=a;this.pos[1]=b;this.wrapper.__invalid_matrixes=!0;GLView.__should_render=!0},__gl_update_scroll:function(a){if(this.isAnimating){var b;
a>=this.anim_startTime+this.anim_duration?(this.isAnimating=!1,GLView.__nb_animation--,this.wrapper.__is_scrolling=!1,this._translate(this.anim_destX,this.anim_destY),this.resetPosition(this.options.bounceTime)||this._execEvent("scrollEnd")):(a=(a-this.anim_startTime)/this.anim_duration,b=this.anim_easingFn(a),a=(this.anim_destX-this.anim_startX)*b+this.anim_startX,this._translate(a,(this.anim_destY-this.anim_startY)*b+this.anim_startY))}},_animate:function(a,b,c,d){this.anim_startX=this.pos[0];this.anim_startY=
this.pos[1];this.anim_startTime=performance.now();this.anim_duration=c;this.anim_easingFn=d;this.anim_destX=a;this.anim_destY=b;this.isAnimating||(this.isAnimating=!0,GLView.__nb_animation++);this.wrapper.__invalid_matrixes=!0;this.wrapper.__is_scrolling=!0;GLView.__should_render=!0},handleEvent:function(a){var b=a.type;b===vs.POINTER_MOVE?this._move(a):b===vs.POINTER_START?this._start(a):b===vs.POINTER_END||b===vs.POINTER_CANCEL?this._end(a):"wheel"===b||"DOMMouseScroll"===b||"mousewheel"===b?this._wheel(a):
"keydown"===b&&this._key(a)}};GLScrollView.__iscroll=c})(window,Math);var GLApplication=function(a){initWebGLRendering();this._layout=void 0;this.parent=GLView;this.parent(a);this.constructor=GLApplication},ORIENTATION_CHANGE_EVT="onorientationchange"in window?"orientationchange":"resize";
GLApplication.prototype={_prevent_scroll:!0,initComponent:function(){vs.Application_applications[this.id]=this;GLView.prototype.initComponent.call(this);this.preventScroll=!0;var a=this;window.addEventListener(ORIENTATION_CHANGE_EVT,function(){var b=window.orientation;util.isNumber(b)||(b=window.outerWidth>=window.outerHeight?90:0);(b=window.deviceConfiguration.setOrientation(b))&&a.propagate("deviceChanged",b,null,!0)});this.size=[window.innerWidth,window.innerHeight]},exit:function(){vs.ui.Application.exit()},
applicationStarted:function(){},setActiveStyleSheet:function(a){vs.ui.Application.setActiveStyleSheet(a)},orientationWillChange:function(){},buildDataflow:function(){vs._default_df_.build()},loadScript:function(a){var b=this;util.importFile(a,document,function(a){a&&b.propagate("scriptloaded",a)},"js")},loadCSS:function(a){var b=this;util.importFile(a,document,function(a){a&&b.propagate("cssloaded",a)},"css")}};util.extendClass(GLApplication,GLView);
util.defineClassProperties(GLApplication,{preventScroll:{set:function(a){this._prevent_scroll=a?!0:!1;document.preventScroll=a},get:function(){this._prevent_scroll=document.preventScroll;return this.__prevent_scroll}}});ui.GLApplication=GLApplication;
function __create_multiline_text(a,b,c,d){var e="",f,g,h=b.split(" "),j;j=h.length;for(var k=0,l,m;k<j;)if(b=h[k],f=""!=e?e+" "+b:b,a.measureText(f).width<c)e=f,k++;else if(a.measureText(b).width<c)d.push(e),e=b,k++;else{l=0;m=b.length;for(f=e+" ";l<m;)if(g=f+b[l],a.measureText(g).width>=c){d.push(f);e=b.substr(l);k++;break}else f=g,l++}if(e)if(a.measureText(e).width<c)d.push(e);else{l=0;m=e.length;for(f="";l<m;)g=f+e[l],a.measureText(g).width>=c?(d.push(f),f=e[l]):f=g,l++;f&&d.push(f)}return 0}
function _create_multiline_text(a,b,c,d){var e=0;b.split("\n").forEach(function(b){e=Math.max(e,__create_multiline_text(a,b,c,d))});return e}
function __render_text_into_canvas_ctx(a,b,c,d,e){b.clearRect(0,0,c,d);var f=e.color,g=[],h;f||(f=GLColor.white);var j=e.fontWeight+" "+e._font_size*gl_device_pixel_ratio+"px "+e.fontFamily;b.fillStyle=f.getRgbaString();b.strokeStyle=f.getRgbaString();b.font=j;b.textAlign=e.textAlign;b.textBaseline="middle";_create_multiline_text(b,a,c,g);h=d/2-(g.length-1)*e._font_size*gl_device_pixel_ratio/2;g.forEach(function(a,d){var f=d*e._font_size*gl_device_pixel_ratio+h;switch(e.textAlign){case "left":b.fillText(a,
0,f);break;case "right":b.measureText(a);b.fillText(a,c,f);break;case "center":b.fillText(a,c/2,f)}});return g.length*e._font_size}
function __copy_image_into_webgl_texture(a,b){b||(b=gl_ctx.createTexture());gl_ctx.pixelStorei(gl_ctx.UNPACK_FLIP_Y_WEBGL,!1);gl_ctx.pixelStorei(gl_ctx.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,b);gl_ctx.texImage2D(gl_ctx.TEXTURE_2D,0,gl_ctx.RGBA,gl_ctx.RGBA,gl_ctx.UNSIGNED_BYTE,a);0!==a.width&&0===(a.width&a.width-1)&&0!==a.height&&0===(a.height&a.height-1)?(gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_MAG_FILTER,gl_ctx.LINEAR),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,
gl_ctx.TEXTURE_MIN_FILTER,gl_ctx.NEAREST_MIPMAP_LINEAR),gl_ctx.generateMipmap(gl_ctx.TEXTURE_2D)):(gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_MIN_FILTER,gl_ctx.LINEAR),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_WRAP_S,gl_ctx.CLAMP_TO_EDGE),gl_ctx.texParameteri(gl_ctx.TEXTURE_2D,gl_ctx.TEXTURE_WRAP_T,gl_ctx.CLAMP_TO_EDGE));gl_ctx.bindTexture(gl_ctx.TEXTURE_2D,null);GLView.__should_render=!0;return b}
var __text_management={__text_canvas_ctx:null,__text_canvas_node:null,__init_text_view:function(a){this.__text_canvas_node=create2DCanvas(a[0],a[1]);this.__text_canvas_ctx=this.__text_canvas_node.getContext("2d")},__update_text_view:function(a){this.__text_canvas_node.style.width=a[0]+"px";this.__text_canvas_node.style.height=a[1]+"px";this.__text_canvas_node.width=a[0]*gl_device_pixel_ratio;this.__text_canvas_node.height=a[1]*gl_device_pixel_ratio},__update_text:function(a,b){if(!this.__text_canvas_node.width||
!this.__text_canvas_node.height){var c=this;vs.requestAnimationFrame(function(){c.__update_text(a)})}else{var d=__render_text_into_canvas_ctx(a,this.__text_canvas_ctx,this._size[0]*gl_device_pixel_ratio,this._size[1]*gl_device_pixel_ratio,this._style);b&&d>this._size[1]?this.size=[this._size[0],d]:this.__update_texture()}},__update_texture:function(){update_texture(this,this.__text_canvas_node)}};function GLText(a){this.parent=GLView;this.parent(a);this.constructor=GLText}
GLText.prototype={_text:"",initComponent:function(){GLView.prototype.initComponent.call(this);this._style.backgroundColor=GLColor.transparent;var a=this.__config__.size;a||(a=[20,20],this.__config__.size=a);this.__init_text_view(a);""!=this._text&&this.__update_text(this._text,!0)},refresh:function(){GLView.prototype.refresh.call(this);""!=this._text&&(this.__update_text_view(this._size),this.__update_text(this._text,!0))},redraw:function(a){GLView.prototype.redraw.call(this);this.__update_text(this._text,
!0);a&&a()}};util.extend(GLText.prototype,__text_management);util.extendClass(GLText,GLView);
util.defineClassProperties(GLText,{text:{set:function(a){if(null===a||"undefined"===typeof a)a="";else if(util.isNumber(a))a=""+a;else if(!util.isString(a)){if(!a.toString)return;a=a.toString()}a!=this._text&&(this._text=a,this.__update_text(this._text,!0))},get:function(){return this._text}},size:{set:function(a){a&&util.isArray(a)&&2===a.length&&util.isNumber(a[0])&&util.isNumber(a[1])&&(this._size[0]=a[0],this._size[1]=a[1],this._updateSizeAndPos(),this.__update_text_view(this._size),""!=this._text&&
this.__update_text(this._text,!0))},get:function(){return this._size.slice()}}});ui.GLText=GLText;var __gl_textures_ref={};
function gl_get_texture_from_image_url(a,b){var c=__gl_textures_ref[a];if(c){if(c.ref_count++,vs.util.isFunction(b))if(c.texture)try{b(c.texture)}catch(d){d.stack&&console.log(d.stack),console.log(d)}else c.clbs.push(b)}else{c={texture:null,ref_count:1,clbs:[]};vs.util.isFunction(b)&&c.clbs.push(b);__gl_textures_ref[a]=c;var e=new Image;e.src=a;e.onload=function(){var b,c=__gl_textures_ref[a];if(c){b=__copy_image_into_webgl_texture(e,b);c.texture=b;var d=c.clbs;c.clbs=[];d.forEach(function(a){try{a(b,
[e.width,e.height])}catch(c){c.stack&&console.log(c.stack),console.log(c)}})}}}}function gl_get_texture_from_image_url_not_optimize(a,b){var c=new Image;c.src=a;c.onload=function(){var a;a=__copy_image_into_webgl_texture(c,a);try{b(a,[c.width,c.height])}catch(e){e.stack&&console.log(e.stack),console.log(e)}}}function gl_free_texture_image(a){var b=__gl_textures_ref[a];b&&(b.ref_count--,0<b.ref_count||(b.texture&&gl_ctx.deleteTexture(b.texture),delete __gl_textures_ref[a]))}
function GLImage(a){this.parent=GLView;this.parent(a);this.constructor=GLImage}GLImage.prototype={_src:null,destructor:function(){GLView.prototype.destructor.call(this);gl_free_texture_image(this._src)},initComponent:function(){GLView.prototype.initComponent.call(this);this._style.backgroundColor=GLColor.transparent}};util.extendClass(GLImage,GLView);
util.defineClassProperties(GLImage,{src:{set:function(a){if(util.isString(a)){this._src&&(gl_free_texture_image(this._src),clean_image_texture(this));this._src=a;var b=this;gl_get_texture_from_image_url(b._src,function(a,d){set_image_texture(b,a);0===b._size[0]&&0===b._size[1]&&(b.size=d)})}},get:function(){return this._src}}});ui.GLImage=GLImage;function GLCanvas(a){this.parent=GLView;this.parent(a);this.constructor=GLCanvas}
GLCanvas.prototype={__canvas_ctx:null,__canvas_node:null,initComponent:function(){GLView.prototype.initComponent.call(this);this.__canvas_node=create2DCanvas(this._size[0],this._size[1]);this.__canvas_ctx=this.__canvas_node.getContext("2d");this.draw(0,0,this._size[0]*gl_device_pixel_ratio,this._size[1]*gl_device_pixel_ratio)},_updateSizeAndPos:function(){GLView.prototype._updateSizeAndPos.call(this);this.__canvas_node.style.width=this._size[0]+"px";this.__canvas_node.style.height=this._size[1]+"px";
this.__canvas_node.width=this._size[0]*gl_device_pixel_ratio;this.__canvas_node.height=this._size[1]*gl_device_pixel_ratio;this.draw(0,0,this._size[0]*gl_device_pixel_ratio,this._size[1]*gl_device_pixel_ratio)},__update_texture:function(){update_texture(this,this.__canvas_node)},getContext:function(){return this.__canvas_ctx},drawRect:function(a,b,c,d,e,f){if(4===arguments.length)this.c_rect(a,b,c,d).stroke();else if(f){Math.sin(f);Math.cos(f);var g=[a,b],h=this.rotatePoint(c,0,f);g.push(a+h[0],b+
h[1]);h=this.rotatePoint(c,d,f);g.push(a+h[0],b+h[1]);h=this.rotatePoint(0,d,f);g.push(a+h[0],b+h[1]);e&&g.push(e);this.c_polygon.apply(this,g)}else this.c_polygon(a,b,a+c,b,a+c,b+d,a,b+d,e);return this},rotatePoint:function(a,b,c){return[a*Math.cos(c)-b*Math.sin(c),b*Math.cos(c)+a*Math.sin(c)]},c_polygon:function(){if(6>arguments.length)throw Error("not enough arguments");var a,b,c,d;this.c_beginPath();if(0===arguments.length%2){this.c_moveTo(arguments[0],arguments[1]);for(a=2;a<arguments.length;a+=
2)this.c_lineTo(arguments[a],arguments[a+1])}else{b=arguments[arguments.length-1];c=(arguments.length-1)/2;a=(arguments[2*c-2]+arguments[0])/2;d=(arguments[2*c-1]+arguments[1])/2;this.c_moveTo(a,d);for(a=0;a<c-1;a++)this.c_arcTo(arguments[2*a],arguments[2*a+1],arguments[2*a+2],arguments[2*a+3],b);this.c_arcTo(arguments[2*c-2],arguments[2*c-1],arguments[0],arguments[1],b)}this.c_closePath();this.c_moveTo(arguments[0],arguments[1]);this.c_stroke();return this},c_ellipse:function(a,b,c,d,e,f,g,h){void 0===
e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=2*Math.PI);void 0===h&&(h=!1);var j=this.rotatePoint(c*Math.cos(f),d*Math.sin(f),e),k=a+j[0],j=b+j[1];this.rotatePoint(c*Math.cos(g),d*Math.sin(g),e);this.c_moveTo(k,j);this.c_translate(a,b);this.c_rotate(e);this.c_scale(c/d,1);this.c_arc(0,0,d,f,g,h);this.c_scale(d/c,1);this.c_rotate(-e);this.c_translate(-a,-b);this.c_stroke();return this},draw:function(a,b,c,d){a||(a=0);b||(b=0);c||(c=this._size[0]*gl_device_pixel_ratio);d||(d=this._size[1]*gl_device_pixel_ratio);
var e=gl_device_pixel_ratio;this.c_clearRect(a,b,c,d);this.c_lineWidth=3;this.c_shadowColor="white";this.c_shadowBlur=1;for(var f,g,h,a=0;10>a;a++)this.c_strokeStyle="rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")",b=Math.floor(Math.random()*c),f=Math.floor(Math.random()*d),g=Math.floor(Math.random()*c),h=Math.floor(Math.random()*d),this.c_beginPath(),this.c_moveTo(b*e,f*e),this.c_lineTo(g*e,h*e),this.c_closePath(),this.c_stroke();this.__update_texture()}};
util.extendClass(GLCanvas,GLView);GLCanvas.methods="arc,arcTo,beginPath,bezierCurveTo,clearRect,clip,closePath,createImageData,createLinearGradient,createRadialGradient,createPattern,drawFocusRing,drawImage,fill,fillRect,fillText,getImageData,isPointInPath,lineTo,measureText,moveTo,putImageData,quadraticCurveTo,rect,restore,rotate,save,scale,setTransform,stroke,strokeRect,strokeText,transform,translate".split(",");GLCanvas.props="canvas,fillStyle,font,globalAlpha,globalCompositeOperation,lineCap,lineJoin,lineWidth,miterLimit,shadowOffsetX,shadowOffsetY,shadowBlur,shadowColor,strokeStyle,textAlign,textBaseline".split(",");
GLCanvas.setup=function(){var a,b;for(a=0;a<GLCanvas.methods.length;a++)b=GLCanvas.methods[a],GLCanvas.prototype["c_"+b]=function(a){return function(){this.__canvas_ctx[a].apply(this.__canvas_ctx,arguments);return this}}(b);for(a=0;a<GLCanvas.props.length;a++){b=GLCanvas.props[a];var c={enumerable:!0};c.set=function(a){return function(b){this.__canvas_ctx[a]=b}}(b);c.get=function(a){return function(){return this.__canvas_ctx[a]}}(b);util.defineProperty(GLCanvas.prototype,"c_"+b,c)}};GLCanvas.setup();
ui.GLCanvas=GLCanvas;function DragRecognizer(a){this.parent=vs.ui.PointerRecognizer;this.parent(a);this.constructor=DragRecognizer}
DragRecognizer.prototype={__is_dragged:!1,init:function(a){vs.ui.PointerRecognizer.prototype.init.call(this,a);this.addPointerListener(this.obj,core.POINTER_START,this.obj);this.reset()},uninit:function(){this.removePointerListener(this.obj,core.POINTER_START,this.obj)},pointerStart:function(a){if(!this.__is_dragged&&a.targetPointerList&&!(1<a.targetPointerList.length)){var b=a.targetPointerList[0];this.__start_x=b.pageX;this.__start_y=b.pageY;this.__pointer_id=b.identifier;this.__is_dragged=!0;this.addPointerListener(document,
core.POINTER_END,this.obj);this.addPointerListener(document,core.POINTER_MOVE,this.obj);try{this.delegate&&this.delegate.didDragStart&&this.delegate.didDragStart(a.targetPointerList[0].target,a)}catch(c){c.stack&&console.log(c.stack),console.log(c)}return!1}},pointerMove:function(a){if(this.__is_dragged){for(var b=0,c=a.targetPointerList.length,d;b<c;b++){d=a.targetPointerList[b];if(d.identifier===this.__pointer_id)break;d=null}if(d){b=d.pageX-this.__start_x;d=d.pageY-this.__start_y;try{this.delegate&&
this.delegate.didDrag&&this.delegate.didDrag({dx:b,dy:d},a.targetPointerList[0].target,a)}catch(e){e.stack&&console.log(e.stack),console.log(e)}}}},pointerEnd:function(a){if(this.__is_dragged){for(var b=0,c=a.changedPointerList.length,d;b<c;b++){d=a.changedPointerList[b];if(d.identifier===this.__pointer_id)break;d=null}if(d){this.__is_dragged=!1;this.__pointer_id=this.__start_y=this.__start_x=void 0;this.removePointerListener(document,core.POINTER_END,this.obj);this.removePointerListener(document,
core.POINTER_MOVE,this.obj);try{this.delegate&&this.delegate.didDragEnd&&this.delegate.didDragEnd(a.changedPointerList[0].target,a)}catch(e){e.stack&&console.log(e.stack),console.log(e)}}}},pointerCancel:function(a){return this.pointerEnd(a)}};vs.util.extendClass(DragRecognizer,vs.ui.PointerRecognizer);vs.ui.DragRecognizer=DragRecognizer;function PinchRecognizer(a){this.parent=vs.ui.PointerRecognizer;this.parent(a);this.constructor=PinchRecognizer}
PinchRecognizer.prototype={init:function(a){vs.ui.PointerRecognizer.prototype.init.call(this,a);this.addPointerListener(this.obj,core.GESTURE_START,this.obj);this.reset()},uninit:function(){this.removePointerListener(this.obj,core.GESTURE_START,this.obj)},gestureStart:function(){this.addPointerListener(document,core.GESTURE_CHANGE,this.obj);this.addPointerListener(document,core.GESTURE_END,this.obj);try{this.delegate&&this.delegate.didPinchStart&&this.delegate.didPinchStart(event.targetPointerList[0].target,
event)}catch(a){a.stack&&console.log(a.stack),console.log(a)}return!1},gestureChange:function(a){try{this.delegate&&this.delegate.didPinchChange&&this.delegate.didPinchChange(a.scale,a.targetPointerList[0].target,a)}catch(b){b.stack&&console.log(b.stack),console.log(b)}},gestureEnd:function(){this.removePointerListener(document,core.GESTURE_CHANGE,this.obj);this.removePointerListener(document,core.GESTURE_END,this.obj);try{this.delegate&&this.delegate.didPinchEnd&&this.delegate.didPinchEnd(event.targetPointerList[0].target,
event)}catch(a){a.stack&&console.log(a.stack),console.log(a)}},pointerCancel:function(a){return this.pointerEnd(a)}};vs.util.extendClass(PinchRecognizer,vs.ui.PointerRecognizer);vs.ui.PinchRecognizer=PinchRecognizer;function RotationRecognizer(a){this.parent=vs.ui.PointerRecognizer;this.parent(a);this.constructor=RotationRecognizer}
RotationRecognizer.prototype={init:function(a){vs.ui.PointerRecognizer.prototype.init.call(this,a);this.addPointerListener(this.obj,core.GESTURE_START,this.obj);this.reset()},uninit:function(){this.removePointerListener(this.obj,core.GESTURE_START,this.obj)},gestureStart:function(){this.addPointerListener(document,core.GESTURE_CHANGE,this.obj);this.addPointerListener(document,core.GESTURE_END,this.obj);try{this.delegate&&this.delegate.didRotationStart&&this.delegate.didRotationStart(event)}catch(a){a.stack&&
console.log(a.stack),console.log(a)}return!1},gestureChange:function(a){try{this.delegate&&this.delegate.didRotationChange&&this.delegate.didRotationChange(a.rotation,a)}catch(b){b.stack&&console.log(b.stack),console.log(b)}},gestureEnd:function(){this.removePointerListener(document,core.GESTURE_CHANGE,this.obj);this.removePointerListener(document,core.GESTURE_END,this.obj);try{this.delegate&&this.delegate.didRotationEnd&&this.delegate.didRotationEnd(event)}catch(a){a.stack&&console.log(a.stack),
console.log(a)}},pointerCancel:function(a){return this.pointerEnd(a)}};vs.util.extendClass(RotationRecognizer,vs.ui.PointerRecognizer);vs.ui.RotationRecognizer=RotationRecognizer;function TapRecognizer(a){this.parent=vs.ui.PointerRecognizer;this.parent(a);this.constructor=TapRecognizer}var MULTI_TAP_DELAY=100;
TapRecognizer.prototype={__is_touched:!1,__unselect_time_out:0,__unselect_clb:null,__did_tap_time_out:0,__tap_mode:0,init:function(a){vs.ui.PointerRecognizer.prototype.init.call(this,a);this.addPointerListener(this.obj,core.POINTER_START,this.obj);this.reset()},uninit:function(){this.removePointerListener(this.obj,core.POINTER_START,this.obj)},pointerStart:function(a){if(!this.__is_touched&&!(0===a.targetPointerList.length||1<a.nbPointers)){0===this.__tap_mode&&(this.__tap_mode=1);this.__unselect_time_out&&
(clearTimeout(this.__unselect_time_out),this.__unselect_time_out=0,this.__unselect_clb&&this.__unselect_clb());this.__tap_elem=a.targetPointerList[0].target;try{this.delegate&&this.delegate.didTouch&&this.delegate.didTouch(this.__tap_elem,a)}catch(b){b.stack&&console.log(b.stack),console.log(b)}this.__did_tap_time_out&&(this.__tap_mode++,clearTimeout(this.__did_tap_time_out),this.__did_tap_time_out=0);this.addPointerListener(document,core.POINTER_END,this.obj);this.addPointerListener(document,core.POINTER_MOVE,
this.obj);this.__start_x=a.targetPointerList[0].pageX;this.__start_y=a.targetPointerList[0].pageY;this.__is_touched=!0;return!1}},pointerMove:function(a){if(this.__is_touched&&0!==a.targetPointerList.length){var b=a.targetPointerList[0].pageY-this.__start_y;if(Math.abs(a.targetPointerList[0].pageX-this.__start_x)+Math.abs(b)<vs.ui.View.MOVE_THRESHOLD)return!1;this.removePointerListener(document,core.POINTER_END,this.obj);this.removePointerListener(document,core.POINTER_MOVE,this.obj);this.__is_touched=
!1;try{this.delegate&&this.delegate.didUntouch&&this.delegate.didUntouch(this.__tap_elem,a)}catch(c){c.stack&&console.log(c.stack),console.log(c)}}},pointerEnd:function(a){if(this.__is_touched){this.__is_touched=!1;var b=this,c=b.__tap_elem;b.__tap_elem=void 0;this.removePointerListener(document,core.POINTER_END,this.obj);this.removePointerListener(document,core.POINTER_MOVE,this.obj);this.delegate&&this.delegate.didUntouch&&(this.__unselect_clb=function(){try{b.delegate.didUntouch(c,a)}catch(d){d.stack&&
console.log(d.stack),console.log(d)}b.__unselect_time_out=0;delete b.__unselect_clb},this.__unselect_time_out=setTimeout(this.__unselect_clb,vs.ui.View.UNSELECT_DELAY));this.delegate&&this.delegate.didTap?this.__did_tap_time_out=setTimeout(function(){try{b.delegate.didTap(b.__tap_mode,c,a)}catch(d){d.stack&&console.log(d.stack),console.log(d)}b.__tap_mode=0;b.__did_tap_time_out=0},MULTI_TAP_DELAY):b.__tap_mode=0}},pointerCancel:function(a){return this.pointerEnd(a)}};
vs.util.extendClass(TapRecognizer,vs.ui.PointerRecognizer);vs.ui.TapRecognizer=TapRecognizer;var Chronometer=function(a){this._state=vs.core.Task.STOPPED;a.duration&&(this._duration=a.duration);a.begin&&(this._begin=a.begin);a.repeat&&(this._repeat=a.repeat);this.__timings__=[]};
Chronometer.prototype={_duration:300,_begin:0,_repeat:1,_tick:0,__time_decl:0,__pause_time:0,__end_time:0,__timings__:null,start:function(a){function b(){this._start_clock()}var c=this.delegate;if(this._state!==vs.core.Task.STARTED){this.__param=a;if(this._state===vs.core.Task.STOPPED){a=this._begin||0;this.__pause_time=this.__time_decl=0;var d=performance.now();if(0<a){vs.scheduleAction(b.bind(this),a);this.__time_decl=0;this.__repeat_dur=this._repeat;this._begin=0;this.__timings__.unshift(d+a);
for(var e=0;e<this.__repeat_dur;e++)this.__timings__.unshift(d+this._duration*(e+1)+a);return}if(-a>this._repeat*this._duration){this.stop();return}this.__time_decl=-a%this._duration;this.__repeat_dur=this._repeat-(-a/this._duration|0);this.__timings__.unshift(d-this.__time_decl);for(e=0;e<this.__repeat_dur;e++)this.__timings__.unshift(d+this._duration*(e+1)-this.__time_decl)}this._start_clock();if(c&&c.taskDidStart)try{c.taskDidStart(this)}catch(f){f.stack&&console.log(f.stack),console.error(f)}}},
_clock:function(a){this._state===vs.core.Task.STARTED&&(a>=this.__end_time?(this._tick=1,this.__clb&&this.__clb(this._tick),1<this.__repeat_dur?(this.__repeat_dur--,this._start_clock()):this.stop()):(this._tick=(a-this.__start_time)/this._duration,0>this._tick&&(this._tick=0),1<this._tick&&(this._tick=1),this.__clb&&this.__clb(this._tick)))},_start_clock:function(){this.__start_time=this.__timings__[this.__repeat_dur];this.__time_decl=0;this.__end_time=this.__timings__[this.__repeat_dur-1];vs.util.isFunction(this.__param)&&
(this.__clb=this.__param);this._state=vs.core.Task.STARTED;this._tick=0;this.__clb&&this.__clb(this._tick)},stop:function(){var a=this.delegate;this._state=vs.core.Task.STOPPED;this.__pause_time=0;this.__timings__.length=0;this._tick=1;this.__clb&&this.__clb(this._tick);if(a&&a.taskDidEnd)try{a.taskDidEnd(this)}catch(b){b.stack&&console.log(b.stack),console.error(b)}},pause:function(){!this._state!==vs.core.Task.STARTED&&(this._state=vs.core.Task.PAUSED,this.__pause_time=performance.now())}};
var TrajectoriesData=function(){this._data=[]};TrajectoriesData.prototype.add=function(a,b,c){this._data.push([a,b,c])};TrajectoriesData.prototype.compute=function(a){for(var b=this._data.length,c;b--;)c=this._data[b],c[0][c[1]]=c[2].compute(a)};TrajectoriesData.prototype.removeProperty=function(a){for(var b=0,c=this._data.length,d;b<c;)d=this._data[b],d[1]===a?(this._data.remove(b),c--):b++};TrajectoriesData.prototype.mixData=function(a){for(var b=a._data.length,c;b--;)c=a._data[b],this.removeProperty(c[1])};
var Trajectory=function(){this._values=null};Trajectory.prototype.compute=function(){return!1};function getValuesIndex(a,b,c,d,e){var f,g,h;if(0>=c)return a[0][1];if(1<=c)return a[b][1];g=a[0];for(f=1;f<=b;f++)if(h=a[f],c>=h[0])g=h;else return a=(c-g[0])/(h[0]-g[0]),d(g[1],h[1],a,e)}var TrajectoryVect1D=function(a){Trajectory.call(this);this._values=deepArrayClone(a)};util.extendClass(TrajectoryVect1D,Trajectory);function TrajectoryVect1D_op(a,b,c){return a+(b-a)*c}
TrajectoryVect1D.prototype.compute=function(a){return getValuesIndex(this._values,this._values.length-1,a,TrajectoryVect1D_op,null)};var TrajectoryVect2D=function(a){Trajectory.call(this);this._values=deepArrayClone(a);this.out=new glMatrixArrayType(2)};util.extendClass(TrajectoryVect2D,Trajectory);function TrajectoryVect2D_op(a,b,c,d){d[0]=a[0]+(b[0]-a[0])*c;d[1]=a[1]+(b[1]-a[1])*c;return d}
TrajectoryVect2D.prototype.compute=function(a){var b=this._values,c=this.out,a=getValuesIndex(b,b.length-1,a,TrajectoryVect2D_op,c);a!==c&&(c[0]=a[0],c[1]=a[1]);return c};var TrajectoryVect3D=function(a){Trajectory.call(this);this._values=deepArrayClone(a);this.out=new glMatrixArrayType(3)};util.extendClass(TrajectoryVect3D,Trajectory);function TrajectoryVect3D_op(a,b,c,d){d[0]=a[0]+(b[0]-a[0])*c;d[1]=a[1]+(b[1]-a[1])*c;d[2]=a[2]+(b[2]-a[2])*c;return d}
TrajectoryVect3D.prototype.compute=function(a){var b=this._values,c=this.out,a=getValuesIndex(b,b.length-1,a,TrajectoryVect3D_op,c);a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);return c};function GLAnimation(a,b){this.constructor=GLAnimation;this.setAnimations(a,b)}GLAnimation.__css_animations={};
GLAnimation.prototype={begin:0,steps:0,repeat:1,startClb:null,endClb:null,duration:GLAnimation.DEFAULT_DURATION,timing:null,setAnimations:function(a,b){var c,d,e;this.timing=GLAnimation.EASE;this._trajectories={};var f=b?b.classes:{};f||(f={});if(a)for(c in a)d=a[c],util.isString(c)?(e=[],e.push([1,deepArrayClone(d)]),this._trajectories[c]=e,f[c]&&(this._trajectories[c+"_class"]=f[c])):console.warn("vs.fx.GLAnimation, invalid constructor argument option: ["+c+", "+d+"]")},keyFrame:function(a,b){function c(a,
b,c){for(var d=0,e=a.length,f;d<e;d++)if(f=a[d],f[0]===b){f[1]=deepArrayClone(c);return}a.push([b,deepArrayClone(c)]);a.sort(function(a,b){return a[0]-b[0]})}var d,e,f;if(b&&util.isNumber(a)&&!(0>a||1<a))for(d in b)f=b[d],e=this._trajectories[d],e||(e=[],this._trajectories[d]=e),c(e,a,f)},process:function(a,b,c,d){return procesAnimation(a,this,this._trajectories,b,c,d)}};GLAnimation.EASE=generateCubicBezierFunction(0.25,0.1,0.25,1);GLAnimation.LINEAR=function(a){return a};
GLAnimation.EASE_IN=generateCubicBezierFunction(0.42,0,1,1);GLAnimation.EASE_OUT=generateCubicBezierFunction(0,0,0.58,1);GLAnimation.EASE_IN_OUT=generateCubicBezierFunction(0.42,0,0.58,1);GLAnimation.EASE_OUT_IN=generateCubicBezierFunction(0,0.42,1,0.58);GLAnimation.DEFAULT_DURATION=300;GLAnimation.DEFAULT_TIMING=GLAnimation.EASE;var AnimationDefaultOption={duration:GLAnimation.DEFAULT_DURATION,timing:GLAnimation.DEFAULT_TIMING,begin:0,steps:0,repeat:1};vs.fx.GLAnimation=GLAnimation;var FadeIn=new GLAnimation({opacity:1});
FadeIn.keyFrame(0,{opacity:0});var FadeOut=new GLAnimation({opacity:0});FadeOut.keyFrame(0,{opacity:1});var Bounce=new GLAnimation({translation:[0,0]});Bounce.keyFrame(0,{translation:[0,0]});Bounce.keyFrame(0.2,{translation:[0,0]});Bounce.keyFrame(0.4,{translation:[0,-30]});Bounce.keyFrame(0.5,{translation:[0,0]});Bounce.keyFrame(0.6,{translation:[0,-15]});Bounce.keyFrame(0.8,{translation:[0,0]});Bounce.duration=1E3;var Shake=new GLAnimation({translation:[0,0]});Shake.keyFrame(0,{translation:[0,0]});
Shake.keyFrame(0.1,{translation:[-10,0]});Shake.keyFrame(0.2,{translation:[10,0]});Shake.keyFrame(0.3,{translation:[-10,0]});Shake.keyFrame(0.4,{translation:[10,0]});Shake.keyFrame(0.5,{translation:[-10,0]});Shake.keyFrame(0.6,{translation:[10,0]});Shake.keyFrame(0.7,{translation:[-10,0]});Shake.keyFrame(0.8,{translation:[10,0]});Shake.keyFrame(0.9,{translation:[0,0]});Shake.duration=1E3;var Swing=new GLAnimation({rotation:0});Swing.keyFrame(0,{rotation:0});Swing.keyFrame(0.2,{rotation:15});
Swing.keyFrame(0.4,{rotation:-10});Swing.keyFrame(0.6,{rotation:5});Swing.keyFrame(0.8,{rotation:-5});Swing.duration=1E3;Swing.origin=[50,0];var Pulse=new GLAnimation({scaling:1});Pulse.keyFrame(0,{scaling:1});Pulse.keyFrame(0.5,{scaling:1.1});Pulse.keyFrame(0.8,{scaling:0.97});Pulse.duration=1E3;var FlipInX=new GLAnimation({rotation:[0,0,0],opacity:1});FlipInX.keyFrame(0,{rotation:[90,0,0],opacity:0});FlipInX.keyFrame(0.4,{rotation:[-10,0,0],opacity:1});FlipInX.keyFrame(0.7,{rotation:[10,0,0],opacity:1});
FlipInX.duration=500;var FlipOutX=new GLAnimation({rotation:[90,0,0],opacity:0});FlipOutX.keyFrame(0,{rotation:[0,0,0],opacity:1});FlipOutX.duration=500;var FlipInY=new GLAnimation({rotation:[0,0,0],opacity:1});FlipInY.keyFrame(0,{rotation:[0,90,0],opacity:0});FlipInY.keyFrame(0.4,{rotation:[0,-10,0],opacity:1});FlipInY.keyFrame(0.7,{rotation:[0,10,0],opacity:1});FlipInY.duration=500;var FlipOutY=new GLAnimation({rotation:[0,90,0],opacity:0});FlipOutY.keyFrame(0,{rotation:[0,0,0],opacity:1});
FlipOutY.duration=500;var FadeInUp=new GLAnimation({translation:[0,0],opacity:1});FadeInUp.keyFrame(0,{translation:[0,20],opacity:0});FadeInUp.duration=500;var FadeOutUp=new GLAnimation({translation:[0,-20],opacity:0});FadeOutUp.keyFrame(0,{translation:[0,0],opacity:1});FadeOutUp.duration=500;var FadeInDown=new GLAnimation({translation:[0,0],opacity:1});FadeInDown.keyFrame(0,{translation:[0,-20],opacity:0});FadeInDown.duration=1E3;var FadeOutDown=new GLAnimation({translation:[0,20],opacity:0});
FadeOutDown.keyFrame(0,{translation:[0,0],opacity:1});FadeOutDown.duration=300;var FadeInLeft=new GLAnimation({translation:[0,0],opacity:1});FadeInLeft.keyFrame(0,{translation:[-20,0],opacity:0});FadeInLeft.duration=1E3;var FadeOutLeft=new GLAnimation({translation:[20,0],opacity:0});FadeOutLeft.keyFrame(0,{translation:[0,0],opacity:1});FadeOutLeft.duration=1E3;var FadeInRight=new GLAnimation({translation:[0,0],opacity:1});FadeInRight.keyFrame(0,{translation:[20,0],opacity:0});
FadeInRight.duration=1E3;var FadeOutRight=new GLAnimation({translation:[-20,0],opacity:0});FadeOutRight.keyFrame(0,{translation:[0,0],opacity:1});FadeOutRight.duration=1E3;util.extend(GLAnimation,{FadeIn:FadeIn,FadeOut:FadeOut,Bounce:Bounce,Shake:Shake,Swing:Swing,Pulse:Pulse,FlipInX:FlipInX,FlipOutX:FlipOutX,FlipInY:FlipInY,FlipOutY:FlipOutY,FadeInUp:FadeInUp,FadeOutUp:FadeOutUp,FadeInDown:FadeInDown,FadeOutDown:FadeOutDown,FadeInLeft:FadeInLeft,FadeOutLeft:FadeOutLeft,FadeInRight:FadeInRight,FadeOutRight:FadeOutRight});
var ANIMATIONS=[];function mixAnimations(a,b){for(var c=0,d=a.length,e;c<d;c++)e=a[c],e.__trajs.mixData(b.__trajs)}
var procesAnimation=function(a,b,c,d,e){var f={},g;for(g in AnimationDefaultOption)f[g]=b[g]?b[g]:AnimationDefaultOption[g];var h=new TrajectoriesData,j=f.timing,k;for(k in c)setupTrajectory(h,a,k,c[k],c[k+"_class"]);f.steps=b.steps|0;1>=f.steps&&(f.steps=0);var l=new Chronometer(f);l.__trajs=h;l.__clb=function(a){h.compute(j(a))};l.delegate={};l.delegate.taskDidEnd=function(){0===f.steps&&setImmediate(function(){ANIMATIONS[a.__gl_id].remove(l);GLView.__nb_animation--});d&&(e||(e=window),d.apply(e))};
0===f.steps&&(b=ANIMATIONS[a.__gl_id],b||(b=[],ANIMATIONS[a.__gl_id]=b),b.push(l),GLView.__nb_animation++);l.start()};function gl_update_animation(a,b){var c=ANIMATIONS[a.__gl_id],d=0,e=c?c.length:0,f;if(e)for(;d<e;d++)f=c[d],f._clock(b)}
var verifyValue=function(a){var b=a.length,c;if(2>b)return!1;c=a[0];if(!c||0!==c[0])return!1;c=a[b-1];return!c||1!==c[0]?!1:!0},setupTrajectory=function(a,b,c,d,e){switch(c){case "opacity":case "fontSize":b=b.style}var f=d[0];if(f){0!==f[0]&&(f=[0,b[c]],d=d.slice(),d.unshift(f));if(!verifyValue(d))throw"Error with the animation. Unvalid property declaration: "+c;if(e)traj=new e(d);else switch(c){case "tick":case "opacity":case "fontSize":case "scaling":traj=new TrajectoryVect1D(d);break;case "translation":case "rotation":traj=
new TrajectoryVect3D(d);break;default:console.log("NOT SUPPORTED PROPERTY: "+c);return}a.add(b,c,traj)}};GLView.prototype.animate=function(a,b){var c={},b=b||{},d;for(d in a)c[d]=[[1,a[d]]];procesAnimation(this,b,c)};function GLButton(a){this.parent=GLView;this.parent(a);this.constructor=GLButton}
GLButton.prototype={__tap_recognizer:null,_selected:!1,_text:"",_released_image:"",_selected_image:"",_disabled_image:"",didTouch:function(){this._selected=!0},didUntouch:function(){this._selected=!1},didTap:function(){this.propagate("select")},destructor:function(){this.__tap_recognizer&&(this.removePointerRecognizer(this.__tap_recognizer),this.__tap_recognizer=null);GLView.prototype.destructor.call(this)},initComponent:function(){GLView.prototype.initComponent.call(this);this.__tap_recognizer||
(this.__tap_recognizer=new vs.ui.TapRecognizer(this),this.addPointerRecognizer(this.__tap_recognizer));this.__init_text_view(this._size);this._text&&this.__update_text(this._text)},refresh:function(){GLView.prototype.refresh.call(this);this._text&&(this.__update_text_view(this._size),this.__update_text(this._text))}};util.extend(GLButton.prototype,__text_management);util.extendClass(GLButton,GLView);
util.defineClassProperties(GLButton,{text:{set:function(a){if(null===a||"undefined"===typeof a)a="";else if(util.isNumber(a))a=""+a;else if(!util.isString(a)){if(!a.toString)return;a=a.toString()}a!=this._text&&(this._text=a,this.__update_text(this._text))},get:function(){return this._text}},size:{set:function(a){a&&util.isArray(a)&&2===a.length&&util.isNumber(a[0])&&util.isNumber(a[1])&&(this._size[0]=a[0],this._size[1]=a[1],this._updateSizeAndPos(),this.__update_text_view(this._size),""!=this._text&&
this.__update_text(this._text))},get:function(){return this._size.slice()}}});ui.GLButton=GLButton;function GLAbstractList(a){this.parent=GLScrollView;this.parent(a);this.constructor=GLScrollView}
GLAbstractList.prototype={__tap_recognizer:null,__list_time_out:0,_items_selectable:!0,_scroll:0,_model:null,__elem:null,__scroll_start:0,destructor:function(){GLScrollView.prototype.destructor.call(this);this._model.unbindChange(null,this,this._modelChanged);this._model_allocated&&util.free(this._model);this._model_allocated=!1},initComponent:function(){GLScrollView.prototype.initComponent.call(this);this._model=new vs.core.Array;this._model.init();this._model_allocated=!0;this._model.bindChange(null,
this,this._modelChanged);this.refresh()},refresh:function(){GLView.prototype.refresh.call(this);var a=this.__children;if(a&&0!==a.length){for(var b=0,c=a.length,d,e=0;b<c;b++)d=a[b],d.position=[0,e],d=d._size,e+=d[1];this.__scroll__&&this.__scroll__.refresh()}},_modelChanged:function(){this._renderData(this._items_selectable);this.refresh()},propertiesDidChange:function(){this._modelChanged();return!0},_renderData:function(){},_touchItemFeedback:function(){},_untouchItemFeedback:function(){},_updateSelectItem:function(){},
didTouch:function(a){if(!this._items_selectable)return!1;a===this._sub_view||a===this.view?this.__elem=null:(this.__elem=a,this.__list_time_out&&(clearTimeout(this.__list_time_out),this.__list_time_out=0),this.__elem_to_unselect&&(this._untouchItemFeedback(this.__elem_to_unselect),this.__elem_to_unselect=null),(this.__elem_to_unselect=a)&&this._touchItemFeedback(a))},didUntouch:function(){!this.__list_time_out&&this.__elem_to_unselect&&(this._untouchItemFeedback(this.__elem_to_unselect),this.__elem_to_unselect=
null);this.__elem=null},didTap:function(a,b){var c=this;if(this.__elem_to_unselect=b)this._updateSelectItem(b),this.__list_time_out=setTimeout(function(){b&&c._untouchItemFeedback(b);c.__list_time_out=0},vs.ui.View.UNSELECT_DELAY)},scrollToElementAt:function(a,b){if(this.__iscroll__){util.isNumber(b);var c=this.__item_obs[a];c&&(c=this.__iscroll__._offset(c.view),c.top+=this.__iscroll__.wrapperOffsetTop,c.top=c.top>this.__iscroll__.minScrollY?this.__iscroll__.minScrollY:c.top<this.__iscroll__.maxScrollY?
this.__iscroll__.maxScrollY:c.top,this.__scroll__.scrollTo(0,c.top,200))}}};util.extendClass(GLAbstractList,GLScrollView);
util.defineClassProperties(GLAbstractList,{scroll:{set:function(a){a?(this._scroll=vs.ui.ScrollView.VERTICAL_SCROLL,this._setup_scroll()):(this._scroll=!1,this._remove_scroll())},get:function(){return this._scroll?!0:!1}},model:{set:function(a){a&&(util.isArray(a)?(this._model.removeAll(),this._model.add.apply(this._model,a)):a.toJSON&&a.propertyChange&&(this._model_allocated&&(this._model.unbindChange(null,this,this._modelChanged),util.free(this._model)),this._model_allocated=!1,this._model=a,this._model.bindChange(null,
this,this._modelChanged)),this.inPropertyDidChange())},get:function(){return this._model}},data:{set:function(a){util.isArray(a)&&(this._model_allocated?this._model.removeAll():(this._model=new vs.core.Array,this._model.init(),this._model_allocated=!0,this._model.bindChange(null,this,this._modelChanged)),this._model.add.apply(this._model,a),this.inPropertyDidChange())},get:function(){return this._model._data.slice()}}});ui.GLAbstractList=GLAbstractList;function GLTemplate(a){this._str=a}
GLTemplate.prototype={_str:null,_regexp_templ:/\$\{((([\w\-]+)(\.([\w\.]*)+)?)|@)\}/g,_regexp_index:/\$\{\*([\d]+)\*\}/g,_shadow_view:null,toString:function(){return this._str},compileView:function(a,b){this._shadow_view||(this._shadow_view=_pre_compile_shadow_view(this,a));var c=_instanciate_shadow_view(this._shadow_view,b);c.__shadow_view=this._shadow_view;return c},__extend_component:function(a){this._shadow_view||(this._shadow_view=_pre_compile_shadow_view(this));var b=this._shadow_view.__node.cloneNode(!0);
a.view=b;_instrument_component(a,this._shadow_view,b);a.__shadow_view=this._shadow_view;return b},apply:function(a){function b(b,d,e,f,g){b=a[d];if(g){e=e.split(".");g=1;d=e.length;for(b=a[e[0]];b&&g<d;)b=b[e[g++]]}return b}return!a?this._str:this._str.replace(this._regexp_templ,b)}};function _resolveClass(a){if(!a)return null;for(var a=a.split("."),b=window;b&&a.length;)b=b[a.shift()];return b}
var _template_view_clone=function(a,b){a||(a={});a.node=this.__shadow_view?this.__shadow_view.__node.cloneNode(!0):a.node?a.node:this.view.cloneNode(!0);return core.EventSource.prototype.clone.call(this,a,b)},_template_view__clone=function(a,b){ui.GLView.prototype._clone.call(this,a,b);_instrument_component(a,this.__shadow_view,a.view);a.__shadow_view=this.__shadow_view};function _instrument_component(){}
function _instanciate_shadow_view(a,b){var c=a.__node.cloneNode(!0),d=new a.__class({node:c});_instrument_component(d,a,c);d.init();b&&d.configure(b);d.isProperty("_$_")&&(d._$_=b);return d}
function _pre_compile_shadow_view(a,b){function c(b,d){var e=b.getAttribute("data-iterate");if(e){var j=b.parentElement;j.removeChild(b);-1===d.__all_properties.indexOf(e)&&d.__all_properties.push(e);var k={};d.__list_iterate_prop[e]=k;k.__prop_nodes=[];k.__list_iterate_prop={};k.__parent_node=j;k.__node=b;k.__all_properties=d.__all_properties;k.__class=ui.GLView;d=k}e=b.attributes;j=d;if(e)for(k=e.length;k--;){var l=e.item(k),m,n=l.value,p=[];a._regexp_index.lastIndex=0;if(m=a._regexp_index.exec(n)){for(;m;)m=
parseInt(m[1],10),p.push(m),j.__prop_nodes[m]?j.__prop_nodes[m].push(l):j.__prop_nodes[m]=[l],m=a._regexp_index.exec(n);l.value="";for(var o=0;o<p.length;o++)m=p[o],n=n.replace("${*"+m+"*}",'"+this._'+util.underscore(j.__all_properties[m])+'+"');l.__attr_eval_str='"'+n+'"'}}e=b.childNodes;j=d;if(e)for(k=e.length;k--;)if(l=e.item(k),3===l.nodeType){n=l.data;m=0;a._regexp_index.lastIndex=0;l.data=" ";for(p=a._regexp_index.exec(n);p;)if(p.index&&(o=document.createTextNode(n.substring(m,p.index)),b.insertBefore(o,
l)),m=parseInt(p[1],10),j.__prop_nodes[m]?j.__prop_nodes[m].push(l):j.__prop_nodes[m]=[l],m=p.index+p[0].length,p=a._regexp_index.exec(n))o=document.createTextNode(" "),l.nextSibling?b.insertBefore(o,l.nextSibling):b.appendChild(o),l=o;if(n=n.substring(m))o=document.createTextNode(n),l.nextSibling?b.insertBefore(o,l.nextSibling):b.appendChild(o)}else 1===l.nodeType&&c(l,j)}var d={__prop_nodes:[],__list_iterate_prop:{},__all_properties:[]};d.__class=_resolveClass(b);util.isFunction(d.__class)||(d.__class=
ui.GLView);a._regexp_templ.lastIndex=0;var e=a._str.replace(a._regexp_templ,function(a,b){var c=d.__all_properties.indexOf(b);-1===c&&(c=d.__all_properties.length,d.__all_properties.push(b));return"${*"+c+"*}"});d.__node=GLTemplate.parseHTML(e);c(d.__node,d);return d}
var _getPaths=function(a,b){for(var c=[],d=0,e=b.length,f;d<e;d++)f=b[d],c.push([_getPath(a,f),f.__attr_eval_str]);return c},_getPath=function(a,b,c){var d=1,c=c||[];if(2===b.nodeType)return b.ownerElement&&(c=_getPath(a,b.ownerElement,c)),c.push([2,b.nodeName.toLowerCase()]),c;if(a===b)return c;b.parentNode&&(c=_getPath(a,b.parentNode,c));for(a=b.previousSibling;a;)(1===a.nodeType||3===a.nodeType)&&a.nodeName==b.nodeName&&d++,a=a.previousSibling;c.push([1,b.nodeName.toLowerCase(),d]);return c},_evalPaths=
function(a,b){for(var c=[],d=0,e=b.length,f,g;d<e;d++)f=b[d],g=_evalPath(a,f[0]),g.__attr_eval_str=f[1],c.push(g);return c},_evalPath=function(a,b){if(!b||!b.length||!a)return a;var c=b.shift(),d,e;d=c[0];var f=c[1];if(2===d){d=a.attributes;for(c=d.length;c--;)if(e=d.item(c),e.nodeName.toLowerCase()==f)return e}else if(1===d){d=a.firstChild;for(c=c[2],e=1;d;){if(d.nodeName.toLowerCase()===f){if(c===e)return _evalPath(d,b);e++}d=d.nextSibling}}return null};
GLTemplate.parseHTML=function(a){var b=document.createElement("div");try{util.safeInnerHTML(b,a),(b=b.firstElementChild)&&b.parentElement.removeChild(b)}catch(c){console.error("vs.ui.GLTemplate.parseHTML failed:");c.stack&&console.log(c.stack);console.error(c);return}return b};vs.ui.GLTemplate=GLTemplate;function GLList(a){this.parent=GLAbstractList;this.parent(a);this.constructor=GLList}GLList.BLOCK_LIST="BlockList";GLList.TAB_LIST="TabList";GLList.DEFAULT_LIST="DefaultList";
GLList.prototype={_selected_index:0,_selected_item:0,__elem:null,__template_obj:null,__template_class:null,getItems:function(){return this.__item_obs?this.__children.slice():[]},_renderData:defaultListRenderData,_modelChanged:function(){this._renderData(this._items_selectable)},_touchItemFeedback:function(a){a.pressed=!0},_untouchItemFeedback:function(a){a.pressed=!1},_updateSelectItem:function(a){this._selected_index=a.index;this._selected_item=this._model.item(this._selected_index);a.didSelect&&
a.didSelect();this.outPropertyChange();this.propagate("itemselect",{index:this._selected_index,item:this._selected_item})}};util.extendClass(GLList,GLAbstractList);util.defineClassProperties(GLList,{itemsSelectable:{set:function(){}},selectedIndex:{get:function(){return this._selected_index}},selectedItem:{get:function(){return this._selected_item}}});ui.GLList=GLList;
function defaultListRenderData(a){if(this._model){var b=0,c,d=0,e;for(this.removeAllChildren(!0);b<this._model.length;)c=this._model.item(b),this.__template_class?e=(new this.__template_class).init():this.__template_obj&&(e=this.__template_obj.clone()),e?(e.position=[0,d],d+=e._size[1],c instanceof core.Model?e.link(c):e.configure(c),e.index=b,a&&vs.addPointerListener(e.view,core.POINTER_START,this),this.add(e),e.__parent=this,b++,e=null):b++;this.refresh()}}
window.CustomElements=window.CustomElements||{flags:{}};
(function(a){function b(){CustomElements.parser.parse(document);CustomElements.upgradeDocument(document);(window.Platform&&Platform.endOfMicrotask?Platform.endOfMicrotask:vs.scheduleAction)(function(){CustomElements.ready=!0;CustomElements.readyTime=Date.now();window.HTMLImports&&(CustomElements.elapsed=CustomElements.readyTime-HTMLImports.readyTime);document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}));window.HTMLImports&&(HTMLImports.__importsParsingHook=function(a){CustomElements.parser.parse(a.import)})})}
"function"!==typeof window.CustomEvent&&(window.CustomEvent=function(a){var b=document.createEvent("HTMLEvents");b.initEvent(a,!0,!0);return b});"complete"===document.readyState||a.flags.eager?b():"interactive"===document.readyState&&!window.attachEvent&&(!window.HTMLImports||window.HTMLImports.ready)?b():window.addEventListener(window.HTMLImports&&!HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded",b)})(window.CustomElements);
(function(a){function b(a,c,d){var e=a.firstElementChild;if(!e)for(e=a.firstChild;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.nextSibling;for(;e;)!0!==c(e,d)&&b(e,c,d),e=e.nextElementSibling;return null}function c(a,b){for(var c=a.shadowRoot;c;)d(c,b),c=c.olderShadowRoot}function d(a,d){b(a,function(a){if(d(a))return!0;c(a,d)});c(a,d)}function e(b){var c;if(!b.__upgraded__&&b.nodeType===Node.ELEMENT_NODE){var d=b.getAttribute("is")||b.localName;a.registry[d]&&(s.dom&&console.group("upgrade:",b.localName),
a.upgrade(b),s.dom&&console.groupEnd(),c=!0)}if(c)return h(b),!0;l(b)}function f(a){d(a,function(a){if(e(a))return!0})}function g(a){return e(a)||f(a)}function h(a){l(a);q(a)&&d(a,function(a){l(a)})}function j(a){y.push(a);x||(x=!0,(window.Platform&&window.Platform.endOfMicrotask||vs.scheduleAction)(k))}function k(){x=!1;for(var a=y,b=0,c=a.length,d;b<c&&(d=a[b]);b++)d();y=[]}function l(a){w?j(function(){m(a)}):m(a)}function m(a){if(a.attachedCallback||a.detachedCallback||a.__upgraded__&&s.dom)s.dom&&
console.group("inserted:",a.localName),q(a)&&(a.__inserted=(a.__inserted||0)+1,1>a.__inserted&&(a.__inserted=1),1<a.__inserted?s.dom&&console.warn("inserted:",a.localName,"insert/remove count:",a.__inserted):a.attachedCallback&&(s.dom&&console.log("inserted:",a.localName),a.attachedCallback())),s.dom&&console.groupEnd()}function n(a){p(a);d(a,function(a){p(a)})}function p(a){w?j(function(){o(a)}):o(a)}function o(a){if(a.attachedCallback||a.detachedCallback||a.__upgraded__&&s.dom)s.dom&&console.group("removed:",
a.localName),q(a)||(a.__inserted=(a.__inserted||0)-1,0<a.__inserted&&(a.__inserted=0),0>a.__inserted?s.dom&&console.warn("removed:",a.localName,"insert/remove count:",a.__inserted):a.detachedCallback&&a.detachedCallback()),s.dom&&console.groupEnd()}function q(a){for(var b=window.ShadowDOMPolyfill?ShadowDOMPolyfill.wrapIfNeeded(document):document;a;){if(a==b)return!0;a=a.parentNode||a.host}}function t(a){if(s.dom){var b=a[0];if(b&&"childList"===b.type&&b.addedNodes&&b.addedNodes){for(b=b.addedNodes[0];b&&
b!==document&&!b.host;)b=b.parentNode;var c=b&&(b.URL||b._URL||b.host&&b.host.localName)||"",c=c.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",a.length,c||"")}a.forEach(function(a){"childList"===a.type&&(B(a.addedNodes,function(a){a.localName&&g(a)}),B(a.removedNodes,function(a){a.localName&&n(a)}))});s.dom&&console.groupEnd()}function r(a){A.observe(a,{childList:!0,subtree:!0})}function u(a){s.dom&&console.group("upgradeDocument: ",a.baseURI.split("/").pop());g(a);s.dom&&
console.groupEnd()}function C(a){a=window.ShadowDOMPolyfill?ShadowDOMPolyfill.wrapIfNeeded(a):a;u(a);for(var a=a.querySelectorAll("link[rel="+z+"]"),b=0,c=a.length,d;b<c&&(d=a[b]);b++)d.import&&d.import.__parsed&&C(d.import)}var s=window.logFlags||{},z=window.HTMLImports?HTMLImports.IMPORT_LINK_TYPE:"none",w=!window.MutationObserver||window.MutationObserver===window.JsMutationObserver;a.hasPolyfillMutations=w;var x=!1,y=[],A=new MutationObserver(t),B=Array.prototype.forEach.call.bind(Array.prototype.forEach);
a.IMPORT_LINK_TYPE=z;a.watchShadow=function(a){if(a.shadowRoot&&!a.shadowRoot.__watched){s.dom&&console.log("watching shadow-root for: ",a.localName);for(a=a.shadowRoot;a;){var b=a;b.__watched||(r(b),b.__watched=!0);a=a.olderShadowRoot}}};a.upgradeDocumentTree=C;a.upgradeAll=g;a.upgradeSubtree=f;a.observeDocument=function(a){r(a)};a.upgradeDocument=u;a.takeRecords=function(){t(A.takeRecords());k()}})(window.CustomElements);
(function(a){var b=a.IMPORT_LINK_TYPE,c={selectors:["link[rel="+b+"]"],map:{link:"parseLink"},parse:function(a){if(!a.__parsed){a.__parsed=!0;var b=a.querySelectorAll(c.selectors);d(b,function(a){c[c.map[a.localName]](a)});CustomElements.upgradeDocument(a);CustomElements.observeDocument(a)}},parseLink:function(a){"link"===a.localName&&a.getAttribute("rel")===b&&this.parseImport(a)},parseImport:function(a){a.import&&c.parse(a.import)}},d=Array.prototype.forEach.call.bind(Array.prototype.forEach);a.parser=
c;a.IMPORT_LINK_TYPE=b})(window.CustomElements);
(function(a){a||(a=window.CustomElements={flags:{}});var b=Boolean(document.registerElement),c=!a.flags.register&&b&&!window.ShadowDOMPolyfill;if(c){var d=function(){};a.registry={};a.upgradeElement=d;a.watchShadow=d;a.upgrade=d;a.upgradeAll=d;a.upgradeSubtree=d;a.observeDocument=d;a.upgradeDocument=d;a.upgradeDocumentTree=d;a.takeRecords=d}else{var e=function(a){return(a=k(a))?e(a.extends).concat([a]):[]},f=function(b,c){c.is&&b.setAttribute("is",c.is);b.removeAttribute("unresolved");if(!Object.__proto__)for(var d=
c.native,e={},f=c.prototype;f!==d&&f!==HTMLUnknownElement.prototype;){for(var g=Object.getOwnPropertyNames(f),j=0,h;h=g[j];j++)e[h]||(Object.defineProperty(b,h,Object.getOwnPropertyDescriptor(f,h)),e[h]=1);f=Object.getPrototypeOf(f)}b.__proto__=c.prototype;b.__upgraded__=!0;b.createdCallback&&b.createdCallback();a.upgradeSubtree(b);return b},g=function(a){if(!a.setAttribute._polyfilled){var b=a.setAttribute;a.setAttribute=function(a,c){h.call(this,a,c,b)};var c=a.removeAttribute;a.removeAttribute=
function(a){h.call(this,a,null,c)};a.setAttribute._polyfilled=!0}},h=function(a,b,c){var d=this.getAttribute(a);c.apply(this,arguments);var e=this.getAttribute(a);this.attributeChangedCallback&&e!==d&&this.attributeChangedCallback(a,d,e)},j={},k=function(a){if(a)return j[a.toLowerCase()]},l=function(a){return function(){return f(m(a.tag),a)}},m=document.createElement.bind(document),n=Node.prototype.cloneNode;document.registerElement=function(b,c){var d=c||{};if(!b)throw Error("document.registerElement: first argument `name` must not be empty");
if(0>b.indexOf("-"))throw Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+b+"'.");if(k(b))throw Error("DuplicateDefinitionError: a type with name '"+b+"' is already registered");if(!d.prototype)throw Error("Options missing required prototype property");d.__name=b.toLowerCase();d.lifecycle=d.lifecycle||{};d.ancestry=e(d.extends);for(var f=d.extends,h=0,m;m=d.ancestry[h];h++)f=m.is&&m.tag;d.tag=f||d.__name;f&&(d.is=d.__name);if(!Object.__proto__){var n=
HTMLElement.prototype;d.is&&(n=document.createElement(d.tag),n=Object.getPrototypeOf(n));for(f=d.prototype;f&&f!==n;)h=Object.getPrototypeOf(f),f=f.__proto__=h}d.native=n;g(d.prototype);j[d.__name]=d;d.ctor=l(d);d.ctor.prototype=d.prototype;d.prototype.constructor=d.ctor;a.ready&&a.upgradeDocumentTree(document);return d.ctor};document.createElement=function(a,b){var c=k(b||a);return c?new c.ctor:m(a)};Node.prototype.cloneNode=function(b){b=n.call(this,b);a.upgradeAll(b);return b};a.registry=j;a.upgrade=
function(a){if(!a.__upgraded__&&a.nodeType===Node.ELEMENT_NODE){var b=a.getAttribute("is")||a.localName;return(b=k(b))&&f(a,b)}}}document.register=document.registerElement;a.hasNative=b;a.useNative=c})(window.CustomElements);var UNMUTABLE_ATTRIBUTES=["id","is","properties","name"];function NO_CONTENT(a){vs.util.removeAllElementChild(a)}function TEXT_CONTENT(a,b){var c=a.textContent;vs.util.removeAllElementChild(a);c&&(b.text=c)}
function RADIO_CHECK_BUTTON_CONTENT(a,b){for(var c=[],d=a.children,e=0,f=d.length,g;e<f;e++)g=d.item(e),"VS-ITEM"==g.nodeName&&c.push(g.textContent);vs.util.removeAllElementChild(a);b.model=c}var EXTERN_COMPONENT={},LOADING_CLBS={};
function get_extern_component(a,b){function c(a,b){var c=LOADING_CLBS[a];c&&(c.forEach(function(a){vs.scheduleAction(function(){a(b)})}),c=[],delete LOADING_CLBS[a])}var d=EXTERN_COMPONENT[a],e;vs.util.isFunction(b)||(b=null);d?b&&b(d):(b&&((e=LOADING_CLBS[a])||(LOADING_CLBS[a]=e=[]),e.push(b)),e=new XMLHttpRequest,e.open("GET",a,!1),e.send(null),4===e.readyState?200===e.status||0===e.status?(d=e.responseText,d=vs.ui.Template.parseHTML(d),EXTERN_COMPONENT[a]=d,c(a,d),e=null):(console.error("Template file for component '"+
comp_name+"' unfound."),c(a,d)):(console.error("Pb when load the component '"+comp_name+"' template."),c(a,d)))}
function declare_extern_component(){var a;a=vs.ui.Template.parseHTML("<div></div>");a=Object.create(a.constructor.prototype);a.createdCallback=function(){var a=this.getAttribute("href");a&&get_extern_component(a)};a.attachedCallback=function(){var a=this,c=this.getAttribute("href"),d=this.getAttribute("id");get_extern_component(c,function(c){if(c){var f=a.parentNode,c=document.importNode(c,!0);d&&c.setAttribute("id",d);console.log(c);f.insertBefore(c,a);f.removeChild(a)}})};a.detachedCallback=function(){console.log("detachedCallback")};
a.attributeChangedCallback=function(){};document.registerElement("vs-import",{prototype:a})}var property_reg=/(\w+):(\w+[.\w+]*)#(\w+)/;function parsePropertiesDeclaration(a){for(var b={},a=a.split(";"),c,d=0;d<a.length;d++)c=property_reg.exec(a[d]),!c||4!=c.length?console.error('Problem with properties declaration "%s"',a[d]):b[c[1]]=[c[2],c[3]];return b}
function _setCompProperties(a,b){var c,d,e;a.__properties__||(a.__properties__=[]);for(d in b)e=b[d],c={},c.set=function(a,b){return function(c){var d=this,e=a.split(".");for(this[b]=c;d&&e.length;)d=d[e.shift()];d&&(d[b]=c);this.propertyChange(b)}}(e[0],e[1]),c.get=function(a,b){return function(){for(var c=this,d=a.split(".");c&&d.length;)c=c[d.shift()];c&&(this[b]=c[b])}}(e[0],e[1]),vs.util.defineProperty(a,d,c),a.__properties__.push(d)}function LIST_TEMPLATE_CONTENT(){}
function LIST_ATTACHED_CALLBACK(){if(this._comp_){console.log("LIST attachedCallback");var a=this.__ext_template,b=this;a&&(delete this.__ext_template,get_extern_component(a,function(a){if(a){var c=buildConfiguration(a);c.node=document.importNode(a,!0);c=(new vs.ui.AbstractListItem(c)).init();if(a=a.getAttribute("properties"))a=parsePropertiesDeclaration(a),_setCompProperties(c,a);b._comp_.setItemTemplate(c);b._comp_._modelChanged()}}));var a=getParentComp(this),c=this.getAttribute("name");a&&(a.add(this._comp_),
c&&(a.isProperty(c)?(console.error('Impossible to define a child, type "%s", with the same name "%s" of a property. Change the component name on your template.',this.nodeName,c),console.log(this)):(a[c]=this._comp_,this.classList.add(c))))}}function ALLOW_CHILD_CONTENT(){}
var LIST_COMPONENT=[["vs.ui.GLText","vs-text",TEXT_CONTENT],["vs.ui.GLButton","vs-button",TEXT_CONTENT],["vs.ui.GLApplication","vs-application",ALLOW_CHILD_CONTENT],["vs.ui.GLCanvas","vs-canvas",NO_CONTENT],["vs.ui.GLImage","vs-image",NO_CONTENT],["vs.ui.GLList","vs-list",LIST_TEMPLATE_CONTENT,null,LIST_ATTACHED_CALLBACK],["vs.ui.GLScrollView","vs-scroll-view",ALLOW_CHILD_CONTENT],["vs.ui.GLView","vs-view",ALLOW_CHILD_CONTENT],["vs.ui.GLView","vs-template",ALLOW_CHILD_CONTENT]];
function INT_DECODER(a){return parseInt(a,10)}function BOOL_DECODER(a){return Boolean(a)}function REF_DECODER(a){var b;try{b=eval(a)}catch(c){c.stack&&console.error(c.stack),console.error(c)}return b}function JSON_DECODER(a){var b;try{b=JSON.parse(a)}catch(c){c.stack&&console.error(c.stack),console.error(c)}return b}function ARRAY_DECODER(a){var b;try{b=JSON.parse(a)}catch(c){c.stack&&console.error(c.stack),console.error(c)}if(vs.util.isArray(b))return b}
function OBJECT_DECODER(a){var b;try{b=JSON.parse(a)}catch(c){c.stack&&console.error(c.stack),console.error(c)}return b}function STRING_DECODER(a){return""+a}function DYNAMIC_DECODER(a,b,c){if(!b||!c)return STRING_DECODER(a);b=b[c];return vs.util.isNumber(b)?INT_DECODER(a):vs.util.isArray(b)?ARRAY_DECODER(a):vs.util.isString(b)||vs.util.isUndefined(b)?STRING_DECODER(a):vs.util.isObject(b)?OBJECT_DECODER(a):STRING_DECODER(a)}
var ATTRIBUTE_DECODERS={magnet:INT_DECODER,range:ARRAY_DECODER},ONLOAD_METHODS=[];function resolveClass(a){if(!a)return null;for(var a=a.split("."),b=window;b&&a.length;)b=b[a.shift()];return b}
function buildConfiguration(a){for(var b={},c=a.attributes,d=c.length,e;d--;)if(e=c.item(d),a=vs.util.camelize(e.name),"id"==a)b.id=e.value;else if("class"!=a&&-1===UNMUTABLE_ATTRIBUTES.indexOf(e.name)&&0!==a.indexOf("on"))if(0===a.indexOf("json:"))b[a.replace("json:","")]=JSON_DECODER(e.value);else if("size"==a||"position"==a||"rotation"==a||"translation"==a)b[a]=JSON_DECODER(e.value);else if("style"==a){var f=new GLStyle;f.parseStringStyle(e.value);b[a]=f}else"constraint"==a?(f=new GLConstraint,
f.parseStringStyle(e.value),b[a]=f):0===a.indexOf("ref:")?b[a.replace("ref:","")]=REF_DECODER(e.value):(f=ATTRIBUTE_DECODERS[a],b[a]=f?f(e.value):DYNAMIC_DECODER(e.value));return b}
function buildBinding(a,b){var c=a.attributes,d,e,f;for(d=0;d<c.length;)if(e=c.item(d),name=vs.util.camelize(e.name),"onload"==name){var g=e.value;g&&ONLOAD_METHODS.push(function(){try{eval(g)}catch(a){a.stack&&console.error(a.stack),console.error(a)}});a.removeAttribute(name)}else 0===name.indexOf("on")?(f=name.substring(2),g=e.value,a.removeAttribute(name),b.bind(f,window,function(){try{eval(g)}catch(a){a.stack&&console.error(a.stack),console.error(a)}})):d++}
function getParentComp(a){return!a?null:(a=a.parentNode)&&a._comp_?a._comp_:getParentComp(a)}
function declareComponent(a,b,c,d,e,f){var g=resolveClass(a),h;if(g)return h=vs.ui.Template.parseHTML("<div></div>"),h=Object.create(h.constructor.prototype),h.createdCallback=vs.util.isFunction(d)?d:function(){var a=buildConfiguration(this),b;c?c(this,a):NO_CONTENT(this);var d=this.getAttribute("class"),e;if(d){for(var d=d.split("."),f=0,h=window[d[f++]];h&&f<d.length;)h=h[d[f++]];h&&f===d.length&&(e=h)}this._comp_=b=e?new e(a):new g(a);"BODY"==this.nodeName&&(this.style.width=frame_size[0]+"px",
this.style.height=frame_size[1]+"px",this.style.overflow="hidden");if(a=this.getAttribute("properties"))a=parsePropertiesDeclaration(a),_setCompProperties(b,a);b.init();e&&ONLOAD_METHODS.push(function(){try{if(b&&b.onload)b.onload()}catch(a){a.stack&&console.error(a.stack),console.error(a)}});buildBinding(this,b)},h.attachedCallback=vs.util.isFunction(e)?e:function(){if(this._comp_){var a,b;a=getParentComp(this);b=this.getAttribute("name");a&&("VS-TEMPLATE"==this.nodeName?a instanceof vs.ui.GLList&&
(window.list=a,a.__template_obj=this._comp_):(a.add(this._comp_),b&&(a.isProperty(b)?(console.error('Impossible to define a child, type "%s", with the same name "%s" of a property. Change the component name on your template.',this.nodeName,b),console.log(this)):(a[b]=this._comp_,this.classList.add(b)))))}},h.detachedCallback=vs.util.isFunction(f)?f:function(){console.log("detachedCallback")},h.attributeChangedCallback=function(a,b,c){if(-1===UNMUTABLE_ATTRIBUTES.indexOf(a)&&(b=this._comp_,a=vs.util.camelize(a),
b))if(0===a.indexOf("json:"))a=a.replace("json:",""),b.isProperty(a)&&(b[a]=JSON_DECODER(c));else if(b.isProperty(a)){var d=ATTRIBUTE_DECODERS[a];b[a]=d?d(c):DYNAMIC_DECODER(c,b,a);b.propagateChange(a)}},d={prototype:h},"vs.ui.GLApplication"==a&&(d.extends="body"),document.registerElement(b,d)}LIST_COMPONENT.forEach(function(a){declareComponent.apply(this,a)});declare_extern_component();window.addEventListener("DOMContentLoaded",function(){document.body.style.opacity=0});
window.addEventListener("WebComponentsReady",function(){ONLOAD_METHODS.forEach(function(a){a.call()});vs.ui.Application.start();vs.scheduleAction(function(){document.body.style.opacity=1})});function endInit(){};
